<?xml version="1.0"?>
<!--Generated by an XSL stylesheet.  Do not edit!-->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta http-equiv="Expires" content="Mon, 10 Jan 2000 12:00:00 GMT"/><style type="text/css">
    p.flushtop     { margin-top: 0px; }
    p.flushbottom  { margin-bottom: 0px; }
    p.flush        { margin-top: 0px;
                     margin-bottom: 0px; }
    h1             { margin-top: 0px;
                     font-weight: bold;
                     font-size: large; }
    h2             { margin-top: 0px;
                     font-weight: bold;
                     font-size: medium; }
    body           { color: black;
                     background-color: white; }
    img.noborder   { border-width: 0px; }
    table.title    { border-style: solid; 
                     border-width: 1px; 
                     border-color: #888888; 
                     color: black;
                     background-color: #E4E4C2; }
    table.item     { border-style: solid; 
                     border-width: 1px; 
                     border-color: #888888; 
                     color: black;
                     background-color: #F4F4E0; }
    table.notes    { border-width: 0px; 
                     color: black;
                     background-color: #E0F4E0; }
    table.comment  { border-width: 0px; 
                     color: black;
                     background-color: #E0F4E0; }
    table.code     { border-style: solid; 
                     border-width: 1px; 
                     border-color: #888888; 
                     color: black;
                     background-color: #E0F4E0; }
    table.contents { border-width: 0px; 
                     color: black;
                     background-color: #FFFFFF; }
    span.red       { color: red; }
    span.orange    { color: orange; }
    span.purple    { color: purple; }
    span.blue      { color: blue; }
    span.brown     { color: brown; }
    span.green     { color: lime; }
    span.hilight   { background-color: #E4E4C2; }
  </style><title>SE450: TimeServer Implementation [2008/10/21]</title></head><body><table width="100%" class="title"><colgroup><col width="100%"/><col align="left"/></colgroup><tr><td><span style="font-weight: bold; font-size: larger"><a href="../index.html">SE450</a>: <a href="class-07-009.html">Simulation: TimeServer Implementation</a></span><span style="font-weight: normal"><a href="class-07.html#slide008"> [8/13] </a></span></td><td valign="top"><a href="class-07-007.html"><img border="0" src="../images/prev.gif" alt="Previous page"/></a><a href="class-07-000.html"><img border="0" src="../images/toc.gif" alt="Contents"/></a><a href="class-07-009.html"><img border="0" src="../images/next.gif" alt="Next page"/></a></td></tr></table><p> </p>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/agent/Agent_java.html">file:Agent.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/agent/Agent.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-publicagent/Agent.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-privateagent/Agent.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> agent<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> 
<span style="color: #000000">00003:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">Agent</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00004:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00005:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00006:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/agent/TimeServer_java.html">file:TimeServer.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/agent/TimeServer.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-publicagent/TimeServer.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-privateagent/TimeServer.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> agent<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> 
<span style="color: #000000">00003:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">TimeServer</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00004:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">double</span> <span style="font-weight: bold"><span style="color: #000000">currentTime</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00005:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span><span style="color: #009900">double</span> waketime<span style="color: #990000">,</span> <span style="color: #008080">Agent</span> thing<span style="color: #990000">);</span>
<span style="color: #000000">00006:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span><span style="color: #009900">double</span> duration<span style="color: #990000">);</span>
<span style="color: #000000">00007:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">addObserver</span></span><span style="color: #990000">(</span>java<span style="color: #990000">.</span>util<span style="color: #990000">.</span><span style="color: #008080">Observer</span> o<span style="color: #990000">);</span>
<span style="color: #000000">00008:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">deleteObserver</span></span><span style="color: #990000">(</span>java<span style="color: #990000">.</span>util<span style="color: #990000">.</span><span style="color: #008080">Observer</span> o<span style="color: #990000">);</span>
<span style="color: #000000">00009:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00010:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
<pre xmlns="" xml:space="preserve">
If you want to use this for the project:

The idea is that whenever an agent adds itself to the timeserver, it
specifies its waketime.  The waketime must be greater than
currenttime, or the enqueue method should throw an exception.  The
timeserver orders agents by their waketime, so the one to wake first is
always at the front.  So in order to run the next agent, the first
agent is dequeued, and then the currenttime is set to its waketime,
then the agent is run.

For a car:
Start the car with waketime=currenttime.
When the car is run(), it should re-enqueue itself with
waketime=currenttime+timestep.

For a light:
Start the lightController with waketime=currenttime.
When the lightController is run(), it should re-enqueue itself with
waketime=currenttime+this._state.getDuration(), where the state
duration is whatever is appropriate for this state.

For a source:
Start the source with waketime=currenttime.
When the source is run(), it should re-enqueue itself with
waketime=currenttime+this._carCreationInterval, where the interval
indicates the time between car creations for this source.        
</pre>
        <p xmlns="">
          I implemented the <tt>TimeServer</tt> using a linked list
          with a <i>dummy node</i>.
        </p>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/agent/TimeServerLinked_java.html">file:TimeServerLinked.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/agent/TimeServerLinked.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-publicagent/TimeServerLinked.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-privateagent/TimeServerLinked.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> agent<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> 
<span style="color: #000000">00003:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>Observable<span style="color: #990000">;</span>
<span style="color: #000000">00004:</span> 
<span style="color: #000000">00005:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">TimeServerLinked</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> Observable <span style="color: #008080">implements</span> TimeServer <span style="color: #FF0000">{</span>
<span style="color: #000000">00006:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Node</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00007:</span>     <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #009900">double</span> waketime<span style="color: #990000">;</span>
<span style="color: #000000">00008:</span>     <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">Agent</span> agent<span style="color: #990000">;</span>
<span style="color: #000000">00009:</span>     <span style="color: #008080">Node</span> next<span style="color: #990000">;</span>
<span style="color: #000000">00010:</span>   
<span style="color: #000000">00011:</span>     <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #000000">Node</span></span><span style="color: #990000">(</span><span style="color: #009900">double</span> waketime<span style="color: #990000">,</span> <span style="color: #008080">Agent</span> agent<span style="color: #990000">,</span> <span style="color: #008080">Node</span> next<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00012:</span>       <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>waketime <span style="color: #990000">=</span> waketime<span style="color: #990000">;</span>
<span style="color: #000000">00013:</span>       <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>agent <span style="color: #990000">=</span> agent<span style="color: #990000">;</span>
<span style="color: #000000">00014:</span>       <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>next <span style="color: #990000">=</span> next<span style="color: #990000">;</span>
<span style="color: #000000">00015:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00016:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00017:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #009900">double</span> _currentTime<span style="color: #990000">;</span>
<span style="color: #000000">00018:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #009900">int</span> _size<span style="color: #990000">;</span>
<span style="color: #000000">00019:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> Node _head<span style="color: #990000">;</span>
<span style="color: #000000">00020:</span> 
<span style="color: #000000">00021:</span>   <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00022:</span> <span style="font-style: italic"><span style="color: #9A1900">  * Invariant: _head != null</span></span>
<span style="color: #000000">00023:</span> <span style="font-style: italic"><span style="color: #9A1900">  * Invariant: _head.agent == null</span></span>
<span style="color: #000000">00024:</span> <span style="font-style: italic"><span style="color: #9A1900">  * Invariant: (_size == 0) iff (_head.next == null)</span></span>
<span style="color: #000000">00025:</span> <span style="font-style: italic"><span style="color: #9A1900">  */</span></span>
<span style="color: #000000">00026:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #000000">TimeServerLinked</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00027:</span>     _size <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
<span style="color: #000000">00028:</span>     _head <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Node</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00029:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00030:</span> 
<span style="color: #000000">00031:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00032:</span>     <span style="color: #008080">StringBuilder</span> sb <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">StringBuilder</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"["</span><span style="color: #990000">);</span>
<span style="color: #000000">00033:</span>     <span style="color: #008080">Node</span> node <span style="color: #990000">=</span> _head<span style="color: #990000">.</span>next<span style="color: #990000">;</span>
<span style="color: #000000">00034:</span>     <span style="color: #008080">String</span> sep <span style="color: #990000">=</span> <span style="color: #FF0000">""</span><span style="color: #990000">;</span>
<span style="color: #000000">00035:</span>     <span style="font-weight: bold"><span style="color: #0000FF">while</span></span> <span style="color: #990000">(</span>node <span style="color: #990000">!=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00036:</span>       sb<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">append</span></span><span style="color: #990000">(</span>sep<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">append</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"("</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">append</span></span><span style="color: #990000">(</span>node<span style="color: #990000">.</span>waketime<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">append</span></span><span style="color: #990000">(</span><span style="color: #FF0000">","</span><span style="color: #990000">)</span>
<span style="color: #000000">00037:</span>         <span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">append</span></span><span style="color: #990000">(</span>node<span style="color: #990000">.</span>agent<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">append</span></span><span style="color: #990000">(</span><span style="color: #FF0000">")"</span><span style="color: #990000">);</span>
<span style="color: #000000">00038:</span>       node <span style="color: #990000">=</span> node<span style="color: #990000">.</span>next<span style="color: #990000">;</span>
<span style="color: #000000">00039:</span>       sep <span style="color: #990000">=</span> <span style="color: #FF0000">";"</span><span style="color: #990000">;</span>
<span style="color: #000000">00040:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00041:</span>     sb<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">append</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"]"</span><span style="color: #990000">);</span>
<span style="color: #000000">00042:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #990000">(</span>sb<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00043:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00044:</span> 
<span style="color: #000000">00045:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">double</span> <span style="font-weight: bold"><span style="color: #000000">currentTime</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00046:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _currentTime<span style="color: #990000">;</span>
<span style="color: #000000">00047:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00048:</span> 
<span style="color: #000000">00049:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span><span style="color: #009900">double</span> waketime<span style="color: #990000">,</span> <span style="color: #008080">Agent</span> agent<span style="color: #990000">)</span>
<span style="color: #000000">00050:</span>     <span style="font-weight: bold"><span style="color: #0000FF">throws</span></span> IllegalArgumentException
<span style="color: #000000">00051:</span>   <span style="color: #FF0000">{</span>
<span style="color: #000000">00052:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>waketime <span style="color: #990000">&lt;</span> _currentTime<span style="color: #990000">)</span>
<span style="color: #000000">00053:</span>       <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">IllegalArgumentException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00054:</span>     <span style="color: #008080">Node</span> prevElement <span style="color: #990000">=</span> _head<span style="color: #990000">;</span>
<span style="color: #000000">00055:</span>     <span style="font-weight: bold"><span style="color: #0000FF">while</span></span> <span style="color: #990000">((</span>prevElement<span style="color: #990000">.</span>next <span style="color: #990000">!=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">)</span> <span style="color: #990000">&amp;&amp;</span>
<span style="color: #000000">00056:</span>         <span style="color: #990000">(</span>prevElement<span style="color: #990000">.</span>next<span style="color: #990000">.</span>waketime <span style="color: #990000">&lt;=</span> waketime<span style="color: #990000">))</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00057:</span>       prevElement <span style="color: #990000">=</span> prevElement<span style="color: #990000">.</span>next<span style="color: #990000">;</span>
<span style="color: #000000">00058:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00059:</span>     <span style="color: #008080">Node</span> newElement <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Node</span></span><span style="color: #990000">(</span>waketime<span style="color: #990000">,</span> agent<span style="color: #990000">,</span> prevElement<span style="color: #990000">.</span>next<span style="color: #990000">);</span>
<span style="color: #000000">00060:</span>     prevElement<span style="color: #990000">.</span>next <span style="color: #990000">=</span> newElement<span style="color: #990000">;</span>
<span style="color: #000000">00061:</span>     _size<span style="color: #990000">++;</span>
<span style="color: #000000">00062:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00063:</span> 
<span style="color: #000000">00064:</span>   <span style="color: #008080">Agent</span> <span style="font-weight: bold"><span style="color: #000000">dequeue</span></span><span style="color: #990000">()</span>
<span style="color: #000000">00065:</span>   <span style="color: #FF0000">{</span>
<span style="color: #000000">00066:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>_size <span style="color: #990000">&lt;</span> <span style="color: #993399">1</span><span style="color: #990000">)</span>
<span style="color: #000000">00067:</span>       <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">NoSuchElementException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00068:</span>     <span style="color: #008080">Agent</span> rval <span style="color: #990000">=</span> _head<span style="color: #990000">.</span>next<span style="color: #990000">.</span>agent<span style="color: #990000">;</span>
<span style="color: #000000">00069:</span>     _head<span style="color: #990000">.</span>next <span style="color: #990000">=</span> _head<span style="color: #990000">.</span>next<span style="color: #990000">.</span>next<span style="color: #990000">;</span>
<span style="color: #000000">00070:</span>     _size<span style="color: #990000">--;</span>
<span style="color: #000000">00071:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> rval<span style="color: #990000">;</span>
<span style="color: #000000">00072:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00073:</span> 
<span style="color: #000000">00074:</span>   <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">size</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00075:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _size<span style="color: #990000">;</span>
<span style="color: #000000">00076:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00077:</span> 
<span style="color: #000000">00078:</span>   <span style="color: #009900">boolean</span> <span style="font-weight: bold"><span style="color: #000000">empty</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00079:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #000000">size</span></span><span style="color: #990000">()</span> <span style="color: #990000">==</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
<span style="color: #000000">00080:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00081:</span> 
<span style="color: #000000">00082:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span><span style="color: #009900">double</span> duration<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00083:</span>     <span style="color: #009900">double</span> endtime <span style="color: #990000">=</span> _currentTime <span style="color: #990000">+</span> duration<span style="color: #990000">;</span>
<span style="color: #000000">00084:</span>     <span style="font-weight: bold"><span style="color: #0000FF">while</span></span> <span style="color: #990000">((!</span><span style="font-weight: bold"><span style="color: #000000">empty</span></span><span style="color: #990000">())</span> <span style="color: #990000">&amp;&amp;</span> <span style="color: #990000">(</span>_head<span style="color: #990000">.</span>next<span style="color: #990000">.</span>waketime <span style="color: #990000">&lt;=</span> endtime<span style="color: #990000">))</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00085:</span>       <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">((</span>_currentTime <span style="color: #990000">-</span> _head<span style="color: #990000">.</span>next<span style="color: #990000">.</span>waketime<span style="color: #990000">)</span> <span style="color: #990000">&gt;</span> <span style="color: #993399">1e-09</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00086:</span>         <span style="font-weight: bold"><span style="color: #0000FF">super</span></span><span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">setChanged</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00087:</span>         <span style="font-weight: bold"><span style="color: #0000FF">super</span></span><span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">notifyObservers</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00088:</span>       <span style="color: #FF0000">}</span>
<span style="color: #000000">00089:</span>       _currentTime <span style="color: #990000">=</span> _head<span style="color: #990000">.</span>next<span style="color: #990000">.</span>waketime<span style="color: #990000">;</span>
<span style="color: #000000">00090:</span>       <span style="font-weight: bold"><span style="color: #000000">dequeue</span></span><span style="color: #990000">().</span><span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00091:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00092:</span>     _currentTime <span style="color: #990000">=</span> endtime<span style="color: #990000">;</span>
<span style="color: #000000">00093:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00094:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00095:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
        <p xmlns="">
          Note below how one tests <tt>TimeServer</tt> without any
          "real" agents.  Instead we use <i>Mock Objects</i>.  We also
          saw this in the tests for <tt>CommandHistoryObj</tt>.
          Tools such as 
          <a xmlns="http://www.w3.org/1999/xhtml" href="http://www.easymock.org/">easymock</a>
          make this easy.
        </p>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/agent/TimeServerTEST_java.html">file:TimeServerTEST.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/agent/TimeServerTEST.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-publicagent/TimeServerTEST.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-privateagent/TimeServerTEST.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> agent<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> junit<span style="color: #990000">.</span>framework<span style="color: #990000">.</span>Assert<span style="color: #990000">;</span>
<span style="color: #000000">00003:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> junit<span style="color: #990000">.</span>framework<span style="color: #990000">.</span>TestCase<span style="color: #990000">;</span>
<span style="color: #000000">00004:</span> 
<span style="color: #000000">00005:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">TimeServerTEST</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> TestCase <span style="color: #FF0000">{</span>
<span style="color: #000000">00006:</span>   <span style="color: #008080">TimeServerQueue</span> q <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">TimeServerQueue</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00007:</span>   <span style="font-style: italic"><span style="color: #9A1900">// TimeServerLinked q = new TimeServerLinked();</span></span>
<span style="color: #000000">00008:</span> 
<span style="color: #000000">00009:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #000000">TimeServerTEST</span></span><span style="color: #990000">(</span><span style="color: #008080">String</span> name<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00010:</span>     <span style="font-weight: bold"><span style="color: #0000FF">super</span></span><span style="color: #990000">(</span>name<span style="color: #990000">);</span>
<span style="color: #000000">00011:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00012:</span> 
<span style="color: #000000">00013:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">testThatEmptySizeIsZero</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00014:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertEquals</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">size</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00015:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00016:</span> 
<span style="color: #000000">00017:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">testThatDequeueOnEmptyThrowsIndexOutOfBoundsException</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00018:</span>     <span style="color: #009900">boolean</span> exceptionOccurred <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">false</span></span><span style="color: #990000">;</span>
<span style="color: #000000">00019:</span> 
<span style="color: #000000">00020:</span>     <span style="font-weight: bold"><span style="color: #0000FF">try</span></span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00021:</span>       <span style="color: #008080">Agent</span> o <span style="color: #990000">=</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">dequeue</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00022:</span>     <span style="color: #FF0000">}</span> <span style="font-weight: bold"><span style="color: #0000FF">catch</span></span> <span style="color: #990000">(</span>java<span style="color: #990000">.</span>util<span style="color: #990000">.</span><span style="color: #008080">NoSuchElementException</span> e<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00023:</span>       exceptionOccurred <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">true</span></span><span style="color: #990000">;</span>
<span style="color: #000000">00024:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00025:</span> 
<span style="color: #000000">00026:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertTrue</span></span><span style="color: #990000">(</span>exceptionOccurred<span style="color: #990000">);</span>
<span style="color: #000000">00027:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00028:</span> 
<span style="color: #000000">00029:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">testThatEnqueueFollowedByDequeueReturnsSameReference</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00030:</span>     <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">TestThatEnqueueFollowedByDequeueReturnsSameReference</span>
<span style="color: #000000">00031:</span>       <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Agent
<span style="color: #000000">00032:</span>     <span style="color: #FF0000">{</span>
<span style="color: #000000">00033:</span>       <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00034:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00035:</span> 
<span style="color: #000000">00036:</span>     <span style="color: #008080">Agent</span> x1 <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">TestThatEnqueueFollowedByDequeueReturnsSameReference</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00037:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">,</span> x1<span style="color: #990000">);</span>
<span style="color: #000000">00038:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertSame</span></span><span style="color: #990000">(</span>x1<span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">dequeue</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00039:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertEquals</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">size</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00040:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00041:</span> 
<span style="color: #000000">00042:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">testThatElementsAreInsertedInOrder</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00043:</span>     <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">TestThatElementsAreInsertedInOrder</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Agent <span style="color: #FF0000">{</span>
<span style="color: #000000">00044:</span>       <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00045:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00046:</span> 
<span style="color: #000000">00047:</span>     <span style="color: #008080">Agent</span> x1 <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">TestThatElementsAreInsertedInOrder</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00048:</span>     <span style="color: #008080">Agent</span> x2 <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">TestThatElementsAreInsertedInOrder</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00049:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">,</span> x2<span style="color: #990000">);</span>
<span style="color: #000000">00050:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">,</span> x1<span style="color: #990000">);</span>
<span style="color: #000000">00051:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertSame</span></span><span style="color: #990000">(</span>x2<span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">dequeue</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00052:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertSame</span></span><span style="color: #990000">(</span>x1<span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">dequeue</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00053:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">,</span> x1<span style="color: #990000">);</span>
<span style="color: #000000">00054:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">,</span> x2<span style="color: #990000">);</span>
<span style="color: #000000">00055:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertSame</span></span><span style="color: #990000">(</span>x2<span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">dequeue</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00056:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertSame</span></span><span style="color: #990000">(</span>x1<span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">dequeue</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00057:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">,</span> x1<span style="color: #990000">);</span>
<span style="color: #000000">00058:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">,</span> x2<span style="color: #990000">);</span>
<span style="color: #000000">00059:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertSame</span></span><span style="color: #990000">(</span>x1<span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">dequeue</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00060:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertSame</span></span><span style="color: #990000">(</span>x2<span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">dequeue</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00061:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">,</span> x2<span style="color: #990000">);</span>
<span style="color: #000000">00062:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">,</span> x1<span style="color: #990000">);</span>
<span style="color: #000000">00063:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertSame</span></span><span style="color: #990000">(</span>x2<span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">dequeue</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00064:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertSame</span></span><span style="color: #990000">(</span>x1<span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">dequeue</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00065:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00066:</span> 
<span style="color: #000000">00067:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">testToString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00068:</span>     <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">TestToString</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Agent <span style="color: #FF0000">{</span>
<span style="color: #000000">00069:</span>       <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00070:</span>       <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #FF0000">"x"</span><span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00071:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00072:</span> 
<span style="color: #000000">00073:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">TestToString</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00074:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">TestToString</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00075:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertEquals</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"[(0.0,x);(1.0,x)]"</span><span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00076:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00077:</span> 
<span style="color: #000000">00078:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">testCurrentTime</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00079:</span>     <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">TestCurrentTime</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Agent <span style="color: #FF0000">{</span>
<span style="color: #000000">00080:</span>       <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00081:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00082:</span> 
<span style="color: #000000">00083:</span>     <span style="color: #009900">double</span> expected <span style="color: #990000">=</span> <span style="color: #993399">1230</span><span style="color: #990000">;</span>
<span style="color: #000000">00084:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span>expected<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">TestCurrentTime</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00085:</span> 
<span style="color: #000000">00086:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertEquals</span></span><span style="color: #990000">(</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">currentTime</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00087:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span>expected<span style="color: #990000">);</span>
<span style="color: #000000">00088:</span>     
<span style="color: #000000">00089:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertEquals</span></span><span style="color: #990000">(</span>expected<span style="color: #990000">,</span> q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">currentTime</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00090:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00091:</span> 
<span style="color: #000000">00092:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #009900">double</span> _scratch<span style="color: #990000">;</span>
<span style="color: #000000">00093:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">testDoActionsAtOrBefore</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00094:</span>     <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">TestDoActionsAtOrBefore</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Agent <span style="color: #FF0000">{</span>
<span style="color: #000000">00095:</span>       <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #009900">double</span> _myScratch<span style="color: #990000">;</span>
<span style="color: #000000">00096:</span>       <span style="font-weight: bold"><span style="color: #000000">TestDoActionsAtOrBefore</span></span><span style="color: #990000">(</span><span style="color: #009900">double</span> myScratch<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00097:</span>         _myScratch <span style="color: #990000">=</span> myScratch<span style="color: #990000">;</span>
<span style="color: #000000">00098:</span>       <span style="color: #FF0000">}</span>
<span style="color: #000000">00099:</span>       <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00100:</span>         _scratch <span style="color: #990000">=</span> _myScratch<span style="color: #990000">;</span>
<span style="color: #000000">00101:</span>       <span style="color: #FF0000">}</span>
<span style="color: #000000">00102:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00103:</span> 
<span style="color: #000000">00104:</span>     <span style="color: #009900">double</span> time1 <span style="color: #990000">=</span> <span style="color: #993399">12</span><span style="color: #990000">;</span>
<span style="color: #000000">00105:</span>     <span style="color: #009900">double</span> time2 <span style="color: #990000">=</span> <span style="color: #993399">23</span><span style="color: #990000">;</span>
<span style="color: #000000">00106:</span>     <span style="color: #009900">double</span> value1 <span style="color: #990000">=</span> <span style="color: #993399">42</span><span style="color: #990000">;</span>
<span style="color: #000000">00107:</span>     <span style="color: #009900">double</span> value2 <span style="color: #990000">=</span> <span style="color: #993399">27</span><span style="color: #990000">;</span>
<span style="color: #000000">00108:</span> 
<span style="color: #000000">00109:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span>time1<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">TestDoActionsAtOrBefore</span></span><span style="color: #990000">(</span>value1<span style="color: #990000">));</span>
<span style="color: #000000">00110:</span> 
<span style="color: #000000">00111:</span>     _scratch <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
<span style="color: #000000">00112:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span>time1 <span style="color: #990000">-</span> <span style="color: #993399">1</span><span style="color: #990000">);</span>
<span style="color: #000000">00113:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertEquals</span></span><span style="color: #990000">(</span><span style="color: #993399">0.0</span><span style="color: #990000">,</span> _scratch<span style="color: #990000">);</span>
<span style="color: #000000">00114:</span> 
<span style="color: #000000">00115:</span>     _scratch <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
<span style="color: #000000">00116:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">);</span>
<span style="color: #000000">00117:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertEquals</span></span><span style="color: #990000">(</span>value1<span style="color: #990000">,</span> _scratch<span style="color: #990000">);</span>
<span style="color: #000000">00118:</span> 
<span style="color: #000000">00119:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">enqueue</span></span><span style="color: #990000">(</span>time2<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">TestDoActionsAtOrBefore</span></span><span style="color: #990000">(</span>value2<span style="color: #990000">));</span>
<span style="color: #000000">00120:</span> 
<span style="color: #000000">00121:</span>     _scratch <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
<span style="color: #000000">00122:</span>     q<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span>time2<span style="color: #990000">);</span>
<span style="color: #000000">00123:</span>     Assert<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">assertEquals</span></span><span style="color: #990000">(</span>value2<span style="color: #990000">,</span> _scratch<span style="color: #990000">);</span>
<span style="color: #000000">00124:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00125:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00126:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
      <p><a href="class-07-007.html"><img border="0" src="../images/prev.gif" alt="Previous page"/></a><a href="class-07-000.html"><img border="0" src="../images/toc.gif" alt="Contents"/></a><a href="class-07-009.html"><img border="0" src="../images/next.gif" alt="Next page"/></a></p><script language="JavaScript1.2" type="text/javascript"><!--
        function next () {
          window.location = 'class-07-009.html';
        }
        document.onkeypress = next;
      --></script></body></html>
