<?xml version="1.0"?>
<!--Generated by an XSL stylesheet.  Do not edit!-->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta http-equiv="Expires" content="Mon, 10 Jan 2000 12:00:00 GMT"/><style type="text/css">
    p.flushtop     { margin-top: 0px; }
    p.flushbottom  { margin-bottom: 0px; }
    p.flush        { margin-top: 0px;
                     margin-bottom: 0px; }
    h1             { margin-top: 0px;
                     font-weight: bold;
                     font-size: large; }
    h2             { margin-top: 0px;
                     font-weight: bold;
                     font-size: medium; }
    body           { color: black;
                     background-color: white; }
    img.noborder   { border-width: 0px; }
    table.title    { border-style: solid; 
                     border-width: 1px; 
                     border-color: #888888; 
                     color: black;
                     background-color: #E4E4C2; }
    table.item     { border-style: solid; 
                     border-width: 1px; 
                     border-color: #888888; 
                     color: black;
                     background-color: #F4F4E0; }
    table.notes    { border-width: 0px; 
                     color: black;
                     background-color: #E0F4E0; }
    table.comment  { border-width: 0px; 
                     color: black;
                     background-color: #E0F4E0; }
    table.code     { border-style: solid; 
                     border-width: 1px; 
                     border-color: #888888; 
                     color: black;
                     background-color: #E0F4E0; }
    table.contents { border-width: 0px; 
                     color: black;
                     background-color: #FFFFFF; }
    span.red       { color: red; }
    span.orange    { color: orange; }
    span.purple    { color: purple; }
    span.blue      { color: blue; }
    span.brown     { color: brown; }
    span.green     { color: lime; }
    span.hilight   { background-color: #E4E4C2; }
  </style><title>SE450:  Lecture 10 
      [2008/11/11]
    </title></head><body><h1><a href="../index.html">SE450</a>:  Lecture 10 
      (Iterator and Visitor)
    </h1><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide000">Contents</a></span><span style="font-weight: normal"><a href="class-10-000.html"> [0/25] </a></span></td></tr></table><p> </p><table width="100%" cellpadding="0" cellspacing="0" class="contents"><tr><td><a href="#slide001">A Linked List: External Iterator</a> [1/25] </td></tr><tr><td><a href="#slide002">A Linked List: Internal Iterator</a> [2/25] </td></tr><tr><td><a href="#slide003">A Linked List: Internal Iterator</a> [3/25] </td></tr><tr><td><a href="#slide004">A Linked List: Visitor</a> [4/25] </td></tr><tr><td><a href="#slide005">A Linked List: External Iterator</a> [5/25] </td></tr><tr><td><a href="#slide006">A Tree: Functions over Composite</a> [6/25] </td></tr><tr><td><a href="#slide007">A Tree: Recall Composite</a> [7/25] </td></tr><tr><td><a href="#slide008">A Tree: Typecase</a> [8/25] </td></tr><tr><td><a href="#slide009">A Tree: Visitor</a> [9/25] </td></tr><tr><td><a href="#slide010">A Tree: External Iterator using a Stack</a> [10/25] </td></tr><tr><td><a href="#slide011">A Tree: External Iterator in CSharp</a> [11/25] </td></tr><tr><td><a href="#slide012">Review: OO Mechanisms: Subtyping (Polymorphism)</a> [12/25] </td></tr><tr><td><a href="#slide013">Review: OO Mechanisms: Dynamic Dispatch</a> [13/25] </td></tr><tr><td><a href="#slide014">Review: OO Mechanisms: Double Dispatch</a> [14/25] </td></tr><tr><td><a href="#slide015">Review: OO Mechanisms: Delegation</a> [15/25] </td></tr><tr><td><a href="#slide016">Review: OO Mechanisms: Classes</a> [16/25] </td></tr><tr><td><a href="#slide017">Review: OO Mechanisms: Subclassing (Inheritance)</a> [17/25] </td></tr><tr><td><a href="#slide018">Review: Pattern Summary: OO Mechanisms</a> [18/25] </td></tr><tr><td><a href="#slide019">Review: Pattern Summary: Basic Concepts</a> [19/25] </td></tr><tr><td><a href="#slide020">Review: Pattern Summary: Controlling the number of instances</a> [20/25] </td></tr><tr><td><a href="#slide021">Review: Pattern Summary: Creating instances</a> [21/25] </td></tr><tr><td><a href="#slide022">Review: Pattern Summary: Structuring Behavior</a> [22/25] </td></tr><tr><td><a href="#slide023">Review: Pattern Summary: Structuring Behavior (Replacing Conditionals)</a> [23/25] </td></tr><tr><td><a href="#slide024">Review: Pattern Summary: Collections</a> [24/25] </td></tr><tr><td><a href="#slide025">What now?</a> [25/25] </td></tr></table><br/><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide001">A Linked List: External Iterator</a></span><span style="font-weight: normal"><a href="class-10-001.html"> [1/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          This is an external iterator over a linked list.
        </p>
        <p xmlns="">
          Here we use a <i>null object</i> or <i>sentinel</i> to mark
          the end of the list.  (This is a degenerate <i>composite</i>.)
        </p>
        <p xmlns="">
          This means that we can sensibly ask an empty list for an
          iterator.  We cannot do this if the empty list is
          represented by <code>null</code>.
        </p>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/iterator/listone/Main_java.html">file:iterator/listone/Main.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/iterator/listone/Main.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/iterator/listone/Main.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/iterator/listone/Main.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> iterator<span style="color: #990000">.</span>listone<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>NoSuchElementException<span style="color: #990000">;</span>
<span style="color: #000000">00003:</span>   
<span style="color: #000000">00004:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00005:</span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">List</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00006:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00007:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00008:</span> 
<span style="color: #000000">00009:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00010:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">ListF</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00011:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #000000">ListF</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00012:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">List</span> nil <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Nil</span></span><span style="color: #990000">();</span> <span style="font-style: italic"><span style="color: #9A1900">/* Singleton */</span></span>
<span style="color: #000000">00013:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">List</span> <span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="font-style: italic"><span style="color: #9A1900">/* Factory */</span></span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00014:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Cons</span></span><span style="color: #990000">(</span>hd<span style="color: #990000">,</span> tl<span style="color: #990000">);</span>
<span style="color: #000000">00015:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00016:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00017:</span> 
<span style="color: #000000">00018:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00019:</span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">Iterator</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00020:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">boolean</span> <span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00021:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00022:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00023:</span> 
<span style="color: #000000">00024:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00025:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00026:</span> <span style="font-style: italic"><span style="color: #9A1900"> * List classes.</span></span>
<span style="color: #000000">00027:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00028:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00029:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Nil</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> List <span style="color: #FF0000">{</span>
<span style="color: #000000">00030:</span>   <span style="font-weight: bold"><span style="color: #000000">Nil</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00031:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #FF0000">"nil"</span><span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00032:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">NullIterator</span></span><span style="color: #990000">();</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00033:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00034:</span> 
<span style="color: #000000">00035:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Cons</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> List <span style="color: #FF0000">{</span>
<span style="color: #000000">00036:</span>   <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #009900">int</span> _hd<span style="color: #990000">;</span>
<span style="color: #000000">00037:</span>   <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> List _tl<span style="color: #990000">;</span>
<span style="color: #000000">00038:</span>   <span style="font-weight: bold"><span style="color: #000000">Cons</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> _hd <span style="color: #990000">=</span> hd<span style="color: #990000">;</span> _tl <span style="color: #990000">=</span> tl<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00039:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _hd <span style="color: #990000">+</span> <span style="color: #FF0000">"::"</span> <span style="color: #990000">+</span> _tl<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">();</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00040:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">ListIterator</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00041:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00042:</span> 
<span style="color: #000000">00043:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">NullIterator</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Iterator <span style="color: #FF0000">{</span>
<span style="color: #000000">00044:</span>   <span style="font-weight: bold"><span style="color: #000000">NullIterator</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00045:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">boolean</span> <span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">false</span></span><span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00046:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">NoSuchElementException</span></span><span style="color: #990000">();</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00047:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00048:</span> 
<span style="color: #000000">00049:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">ListIterator</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Iterator <span style="color: #FF0000">{</span>
<span style="color: #000000">00050:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> List _node<span style="color: #990000">;</span>
<span style="color: #000000">00051:</span>   <span style="font-weight: bold"><span style="color: #000000">ListIterator</span></span><span style="color: #990000">(</span><span style="color: #008080">List</span> node<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> _node <span style="color: #990000">=</span> node<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00052:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">boolean</span> <span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00053:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _node <span style="color: #990000">!=</span> ListF<span style="color: #990000">.</span>nil<span style="color: #990000">;</span>
<span style="color: #000000">00054:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00055:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00056:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span> <span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">())</span>
<span style="color: #000000">00057:</span>       <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">NoSuchElementException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00058:</span>     <span style="color: #009900">int</span> result <span style="color: #990000">=</span> <span style="color: #990000">((</span>Cons<span style="color: #990000">)</span>_node<span style="color: #990000">).</span>_hd<span style="color: #990000">;</span>
<span style="color: #000000">00059:</span>     _node <span style="color: #990000">=</span> <span style="color: #990000">((</span>Cons<span style="color: #990000">)</span>_node<span style="color: #990000">).</span>_tl<span style="color: #990000">;</span>
<span style="color: #000000">00060:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> result<span style="color: #990000">;</span>
<span style="color: #000000">00061:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00062:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00063:</span> 
<span style="color: #000000">00064:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00065:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00066:</span> <span style="font-style: italic"><span style="color: #9A1900"> * A test case.</span></span>
<span style="color: #000000">00067:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00068:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00069:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Main</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00070:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">(</span>String<span style="color: #990000">[]</span> args<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00071:</span>     <span style="color: #008080">List</span> test <span style="color: #990000">=</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">,</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #993399">2</span><span style="color: #990000">,</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #993399">3</span><span style="color: #990000">,</span> ListF<span style="color: #990000">.</span>nil<span style="color: #990000">)));</span>
<span style="color: #000000">00072:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>test<span style="color: #990000">);</span>
<span style="color: #000000">00073:</span> 
<span style="color: #000000">00074:</span>     <span style="color: #009900">int</span> sum<span style="color: #990000">=</span><span style="color: #993399">0</span><span style="color: #990000">;</span>
<span style="color: #000000">00075:</span>     <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="color: #008080">Iterator</span> i <span style="color: #990000">=</span> test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">();</span> i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">();</span> <span style="color: #990000">)</span>
<span style="color: #000000">00076:</span>       sum <span style="color: #990000">+=</span> i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00077:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>sum<span style="color: #990000">);</span>
<span style="color: #000000">00078:</span> 
<span style="color: #000000">00079:</span>     <span style="color: #008080">List</span> rev<span style="color: #990000">=</span>ListF<span style="color: #990000">.</span>nil<span style="color: #990000">;</span>
<span style="color: #000000">00080:</span>     <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="color: #008080">Iterator</span> i <span style="color: #990000">=</span> test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">();</span> i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">();</span> <span style="color: #990000">)</span>
<span style="color: #000000">00081:</span>       rev <span style="color: #990000">=</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span>i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">(),</span>rev<span style="color: #990000">);</span>
<span style="color: #000000">00082:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>rev<span style="color: #990000">);</span>
<span style="color: #000000">00083:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00084:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00085:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
        <p xmlns="">
          Note that the attributes must be package private so that the
          external iterator can access them.
        </p>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide002">A Linked List: Internal Iterator</a></span><span style="font-weight: normal"><a href="class-10-002.html"> [2/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          This is an internal iterator.
        </p>
        <p xmlns="">
          The list controls the traversal.
        </p>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/iterator/listtwo/Main_java.html">file:iterator/listtwo/Main.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/iterator/listtwo/Main.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/iterator/listtwo/Main.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/iterator/listtwo/Main.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> iterator<span style="color: #990000">.</span>listtwo<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>NoSuchElementException<span style="color: #990000">;</span>
<span style="color: #000000">00003:</span>   
<span style="color: #000000">00004:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00005:</span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">List</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00006:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="color: #008080">IntIterator</span> i<span style="color: #990000">);</span>
<span style="color: #000000">00007:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00008:</span> 
<span style="color: #000000">00009:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00010:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">ListF</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00011:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #000000">ListF</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00012:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">List</span> nil <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Nil</span></span><span style="color: #990000">();</span> <span style="font-style: italic"><span style="color: #9A1900">/* Singleton */</span></span>
<span style="color: #000000">00013:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">List</span> <span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="font-style: italic"><span style="color: #9A1900">/* Factory */</span></span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00014:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Cons</span></span><span style="color: #990000">(</span>hd<span style="color: #990000">,</span> tl<span style="color: #990000">);</span>
<span style="color: #000000">00015:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00016:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00017:</span> 
<span style="color: #000000">00018:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00019:</span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">IntIterator</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00020:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> element<span style="color: #990000">);</span>
<span style="color: #000000">00021:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00022:</span> 
<span style="color: #000000">00023:</span> 
<span style="color: #000000">00024:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00025:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00026:</span> <span style="font-style: italic"><span style="color: #9A1900"> * List classes.</span></span>
<span style="color: #000000">00027:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00028:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00029:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Nil</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> List <span style="color: #FF0000">{</span>
<span style="color: #000000">00030:</span>   <span style="font-weight: bold"><span style="color: #000000">Nil</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00031:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #FF0000">"nil"</span><span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00032:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="color: #008080">IntIterator</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00033:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00034:</span> 
<span style="color: #000000">00035:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Cons</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> List <span style="color: #FF0000">{</span>
<span style="color: #000000">00036:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #009900">int</span> _hd<span style="color: #990000">;</span>
<span style="color: #000000">00037:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> List _tl<span style="color: #990000">;</span>
<span style="color: #000000">00038:</span>   <span style="font-weight: bold"><span style="color: #000000">Cons</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> _hd <span style="color: #990000">=</span> hd<span style="color: #990000">;</span> _tl <span style="color: #990000">=</span> tl<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00039:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _hd <span style="color: #990000">+</span> <span style="color: #FF0000">"::"</span> <span style="color: #990000">+</span> _tl<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">();</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00040:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="color: #008080">IntIterator</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00041:</span>     i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span>_hd<span style="color: #990000">);</span>
<span style="color: #000000">00042:</span>     _tl<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span>i<span style="color: #990000">);</span>
<span style="color: #000000">00043:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00044:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00045:</span> 
<span style="color: #000000">00046:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00047:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00048:</span> <span style="font-style: italic"><span style="color: #9A1900"> * Internal Iterators.</span></span>
<span style="color: #000000">00049:</span> <span style="font-style: italic"><span style="color: #9A1900"> * Traversal controlled by the list.</span></span>
<span style="color: #000000">00050:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00051:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00052:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Sum</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> IntIterator <span style="color: #FF0000">{</span>
<span style="color: #000000">00053:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> value <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
<span style="color: #000000">00054:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00055:</span>     value <span style="color: #990000">+=</span> hd<span style="color: #990000">;</span>
<span style="color: #000000">00056:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00057:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00058:</span> 
<span style="color: #000000">00059:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Reverse</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> IntIterator <span style="color: #FF0000">{</span>
<span style="color: #000000">00060:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">List</span> value <span style="color: #990000">=</span> ListF<span style="color: #990000">.</span>nil<span style="color: #990000">;</span>
<span style="color: #000000">00061:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00062:</span>     value <span style="color: #990000">=</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span>hd<span style="color: #990000">,</span> value<span style="color: #990000">);</span>
<span style="color: #000000">00063:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00064:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00065:</span> 
<span style="color: #000000">00066:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00067:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00068:</span> <span style="font-style: italic"><span style="color: #9A1900"> * A test case.</span></span>
<span style="color: #000000">00069:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00070:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00071:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Main</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00072:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">(</span>String<span style="color: #990000">[]</span> args<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00073:</span>     <span style="color: #008080">List</span> test <span style="color: #990000">=</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">,</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #993399">2</span><span style="color: #990000">,</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #993399">3</span><span style="color: #990000">,</span> ListF<span style="color: #990000">.</span>nil<span style="color: #990000">)));</span>
<span style="color: #000000">00074:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>test<span style="color: #990000">);</span>
<span style="color: #000000">00075:</span> 
<span style="color: #000000">00076:</span>     <span style="color: #008080">Sum</span> v1 <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Sum</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00077:</span>     test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span>v1<span style="color: #990000">);</span>
<span style="color: #000000">00078:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>v1<span style="color: #990000">.</span>value<span style="color: #990000">);</span>
<span style="color: #000000">00079:</span> 
<span style="color: #000000">00080:</span>     <span style="color: #008080">Reverse</span> v3 <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Reverse</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00081:</span>     test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span>v3<span style="color: #990000">);</span>
<span style="color: #000000">00082:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>v3<span style="color: #990000">.</span>value<span style="color: #990000">);</span>
<span style="color: #000000">00083:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00084:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00085:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide003">A Linked List: Internal Iterator</a></span><span style="font-weight: normal"><a href="class-10-003.html"> [3/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          This is an internal iterator.
        </p>
        <p xmlns="">
          The iterator controls the traversal.
        </p>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/iterator/listthree/Main_java.html">file:iterator/listthree/Main.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/iterator/listthree/Main.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/iterator/listthree/Main.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/iterator/listthree/Main.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> iterator<span style="color: #990000">.</span>listthree<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>NoSuchElementException<span style="color: #990000">;</span>
<span style="color: #000000">00003:</span>   
<span style="color: #000000">00004:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00005:</span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">List</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00006:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="color: #008080">IntIterator</span> i<span style="color: #990000">);</span>
<span style="color: #000000">00007:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00008:</span> 
<span style="color: #000000">00009:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00010:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">ListF</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00011:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #000000">ListF</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00012:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">List</span> nil <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Nil</span></span><span style="color: #990000">();</span> <span style="font-style: italic"><span style="color: #9A1900">/* Singleton */</span></span>
<span style="color: #000000">00013:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">List</span> <span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="font-style: italic"><span style="color: #9A1900">/* Factory */</span></span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00014:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Cons</span></span><span style="color: #990000">(</span>hd<span style="color: #990000">,</span> tl<span style="color: #990000">);</span>
<span style="color: #000000">00015:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00016:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00017:</span> 
<span style="color: #000000">00018:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00019:</span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">IntIterator</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00020:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> element<span style="color: #990000">,</span> <span style="color: #008080">List</span> rest<span style="color: #990000">);</span>
<span style="color: #000000">00021:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00022:</span> 
<span style="color: #000000">00023:</span> 
<span style="color: #000000">00024:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00025:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00026:</span> <span style="font-style: italic"><span style="color: #9A1900"> * List classes.</span></span>
<span style="color: #000000">00027:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00028:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00029:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Nil</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> List <span style="color: #FF0000">{</span>
<span style="color: #000000">00030:</span>   <span style="font-weight: bold"><span style="color: #000000">Nil</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00031:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #FF0000">"nil"</span><span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00032:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="color: #008080">IntIterator</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00033:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00034:</span> 
<span style="color: #000000">00035:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Cons</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> List <span style="color: #FF0000">{</span>
<span style="color: #000000">00036:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #009900">int</span> _hd<span style="color: #990000">;</span>
<span style="color: #000000">00037:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> List _tl<span style="color: #990000">;</span>
<span style="color: #000000">00038:</span>   <span style="font-weight: bold"><span style="color: #000000">Cons</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> _hd <span style="color: #990000">=</span> hd<span style="color: #990000">;</span> _tl <span style="color: #990000">=</span> tl<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00039:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _hd <span style="color: #990000">+</span> <span style="color: #FF0000">"::"</span> <span style="color: #990000">+</span> _tl<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">();</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00040:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="color: #008080">IntIterator</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00041:</span>     i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span>_hd<span style="color: #990000">,</span> _tl<span style="color: #990000">);</span>
<span style="color: #000000">00042:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00043:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00044:</span> 
<span style="color: #000000">00045:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00046:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00047:</span> <span style="font-style: italic"><span style="color: #9A1900"> * Internal Iterators.</span></span>
<span style="color: #000000">00048:</span> <span style="font-style: italic"><span style="color: #9A1900"> * Traversal controlled by the iterator.</span></span>
<span style="color: #000000">00049:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00050:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00051:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Sum</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> IntIterator <span style="color: #FF0000">{</span>
<span style="color: #000000">00052:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> value <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
<span style="color: #000000">00053:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00054:</span>     value <span style="color: #990000">+=</span> hd<span style="color: #990000">;</span>
<span style="color: #000000">00055:</span>     tl<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00056:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00057:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00058:</span> 
<span style="color: #000000">00059:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Reverse</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> IntIterator <span style="color: #FF0000">{</span>
<span style="color: #000000">00060:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">List</span> value <span style="color: #990000">=</span> ListF<span style="color: #990000">.</span>nil<span style="color: #990000">;</span>
<span style="color: #000000">00061:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00062:</span>     value <span style="color: #990000">=</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span>hd<span style="color: #990000">,</span> value<span style="color: #990000">);</span>
<span style="color: #000000">00063:</span>     tl<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00064:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00065:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00066:</span> 
<span style="color: #000000">00067:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00068:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00069:</span> <span style="font-style: italic"><span style="color: #9A1900"> * A test case.</span></span>
<span style="color: #000000">00070:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00071:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00072:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Main</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00073:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">(</span>String<span style="color: #990000">[]</span> args<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00074:</span>     <span style="color: #008080">List</span> test <span style="color: #990000">=</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">,</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #993399">2</span><span style="color: #990000">,</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #993399">3</span><span style="color: #990000">,</span> ListF<span style="color: #990000">.</span>nil<span style="color: #990000">)));</span>
<span style="color: #000000">00075:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>test<span style="color: #990000">);</span>
<span style="color: #000000">00076:</span> 
<span style="color: #000000">00077:</span>     <span style="color: #008080">Sum</span> v1 <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Sum</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00078:</span>     test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span>v1<span style="color: #990000">);</span>
<span style="color: #000000">00079:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>v1<span style="color: #990000">.</span>value<span style="color: #990000">);</span>
<span style="color: #000000">00080:</span> 
<span style="color: #000000">00081:</span>     <span style="color: #008080">Reverse</span> v3 <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Reverse</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00082:</span>     test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span>v3<span style="color: #990000">);</span>
<span style="color: #000000">00083:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>v3<span style="color: #990000">.</span>value<span style="color: #990000">);</span>
<span style="color: #000000">00084:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00085:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00086:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide004">A Linked List: Visitor</a></span><span style="font-weight: normal"><a href="class-10-004.html"> [4/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          This is visitor.
        </p>
        <p xmlns="">
          A visitor is a double-dispatched iterator.
        </p>
        <p xmlns="">
          Visitors are typically internal iterators in which the
          iterator controls the traversal.  (This is the most flexible
          form, as we will see when we get to trees.)
        </p>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/visitor/list/Main_java.html">file:visitor/list/Main.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/visitor/list/Main.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/visitor/list/Main.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/visitor/list/Main.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> visitor<span style="color: #990000">.</span>list<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> 
<span style="color: #000000">00003:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00004:</span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">List</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00005:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;</span> <span style="color: #008080">T</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="color: #008080">ListVisitor&lt;T&gt;</span> v<span style="color: #990000">);</span>
<span style="color: #000000">00006:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00007:</span> 
<span style="color: #000000">00008:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00009:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">ListF</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00010:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #000000">ListF</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00011:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">List</span> nil <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Nil</span></span><span style="color: #990000">();</span> <span style="font-style: italic"><span style="color: #9A1900">/* Singleton */</span></span>
<span style="color: #000000">00012:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">List</span> <span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="font-style: italic"><span style="color: #9A1900">/* Factory */</span></span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00013:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Cons</span></span><span style="color: #990000">(</span>hd<span style="color: #990000">,</span> tl<span style="color: #990000">);</span>
<span style="color: #000000">00014:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00015:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00016:</span> 
<span style="color: #000000">00017:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00018:</span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">ListVisitor</span><span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00019:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">T</span> <span style="font-weight: bold"><span style="color: #000000">visitNil</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00020:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">T</span> <span style="font-weight: bold"><span style="color: #000000">visitCons</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">);</span>
<span style="color: #000000">00021:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00022:</span> 
<span style="color: #000000">00023:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00024:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00025:</span> <span style="font-style: italic"><span style="color: #9A1900"> * List classes.</span></span>
<span style="color: #000000">00026:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00027:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00028:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Nil</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> List <span style="color: #FF0000">{</span>
<span style="color: #000000">00029:</span>   <span style="font-weight: bold"><span style="color: #000000">Nil</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00030:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #FF0000">"nil"</span><span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00031:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;</span> <span style="color: #008080">T</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="color: #008080">ListVisitor&lt;T&gt;</span> v<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00032:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> v<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">visitNil</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00033:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00034:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00035:</span> 
<span style="color: #000000">00036:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Cons</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> List <span style="color: #FF0000">{</span>
<span style="color: #000000">00037:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #009900">int</span> _hd<span style="color: #990000">;</span>
<span style="color: #000000">00038:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> List _tl<span style="color: #990000">;</span>
<span style="color: #000000">00039:</span>   <span style="font-weight: bold"><span style="color: #000000">Cons</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> _hd <span style="color: #990000">=</span> hd<span style="color: #990000">;</span> _tl <span style="color: #990000">=</span> tl<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00040:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _hd <span style="color: #990000">+</span> <span style="color: #FF0000">"::"</span> <span style="color: #990000">+</span> _tl<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">();</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00041:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;</span> <span style="color: #008080">T</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="color: #008080">ListVisitor&lt;T&gt;</span> v<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00042:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> v<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">visitCons</span></span><span style="color: #990000">(</span>_hd<span style="color: #990000">,</span> _tl<span style="color: #990000">);</span>
<span style="color: #000000">00043:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00044:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00045:</span> 
<span style="color: #000000">00046:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00047:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00048:</span> <span style="font-style: italic"><span style="color: #9A1900"> * Visitor classes.</span></span>
<span style="color: #000000">00049:</span> <span style="font-style: italic"><span style="color: #9A1900"> * The visitor to a Cons is responsible for visiting the tl.</span></span>
<span style="color: #000000">00050:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00051:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00052:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Sum</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> ListVisitor<span style="color: #990000">&lt;</span>Integer<span style="color: #990000">&gt;</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00053:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Integer</span> <span style="font-weight: bold"><span style="color: #000000">visitNil</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #993399">0</span><span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00054:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Integer</span> <span style="font-weight: bold"><span style="color: #000000">visitCons</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00055:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> hd <span style="color: #990000">+</span> tl<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00056:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00057:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00058:</span> 
<span style="color: #000000">00059:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Reverse</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> ListVisitor<span style="color: #990000">&lt;</span>List<span style="color: #990000">&gt;</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00060:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #008080">List</span> result <span style="color: #990000">=</span> ListF<span style="color: #990000">.</span>nil<span style="color: #990000">;</span> <span style="font-style: italic"><span style="color: #9A1900">// use a field to accumulate the value</span></span>
<span style="color: #000000">00061:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">List</span> <span style="font-weight: bold"><span style="color: #000000">visitNil</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> result<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00062:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">List</span> <span style="font-weight: bold"><span style="color: #000000">visitCons</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00063:</span>     result <span style="color: #990000">=</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span>hd<span style="color: #990000">,</span> result<span style="color: #990000">);</span>
<span style="color: #000000">00064:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> tl<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00065:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00066:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00067:</span> 
<span style="color: #000000">00068:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00069:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00070:</span> <span style="font-style: italic"><span style="color: #9A1900"> * A test case.</span></span>
<span style="color: #000000">00071:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00072:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00073:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Main</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00074:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">(</span>String<span style="color: #990000">[]</span> args<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00075:</span>     <span style="color: #008080">List</span> test <span style="color: #990000">=</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">,</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #993399">2</span><span style="color: #990000">,</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #993399">3</span><span style="color: #990000">,</span> ListF<span style="color: #990000">.</span>nil<span style="color: #990000">)));</span>
<span style="color: #000000">00076:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>test<span style="color: #990000">);</span>
<span style="color: #000000">00077:</span> 
<span style="color: #000000">00078:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Sum</span></span><span style="color: #990000">()));</span>
<span style="color: #000000">00079:</span> 
<span style="color: #000000">00080:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Reverse</span></span><span style="color: #990000">()));</span>
<span style="color: #000000">00081:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00082:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00083:</span> 
<span style="color: #000000">00084:</span> 
<span style="color: #000000">00085:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00086:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00087:</span> <span style="font-style: italic"><span style="color: #9A1900"> * Here is the corresponding SML code.</span></span>
<span style="color: #000000">00088:</span> <span style="font-style: italic"><span style="color: #9A1900"> * It is intended to match the Java as closely as possible.</span></span>
<span style="color: #000000">00089:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00090:</span> <span style="font-style: italic"><span style="color: #9A1900">datatype List = Nil | Cons of int * List</span></span>
<span style="color: #000000">00091:</span> 
<span style="color: #000000">00092:</span> <span style="font-style: italic"><span style="color: #9A1900">fun toString (this : List) : string =</span></span>
<span style="color: #000000">00093:</span> <span style="font-style: italic"><span style="color: #9A1900">    case this of</span></span>
<span style="color: #000000">00094:</span> <span style="font-style: italic"><span style="color: #9A1900">        Nil =&gt; "nil"</span></span>
<span style="color: #000000">00095:</span> <span style="font-style: italic"><span style="color: #9A1900">      | Cons(hd, tl) =&gt; Int.toString(hd) ^ "::" ^ toString(tl)</span></span>
<span style="color: #000000">00096:</span> 
<span style="color: #000000">00097:</span> <span style="font-style: italic"><span style="color: #9A1900">fun sum (acceptor : List) : int =</span></span>
<span style="color: #000000">00098:</span> <span style="font-style: italic"><span style="color: #9A1900">    case acceptor of</span></span>
<span style="color: #000000">00099:</span> <span style="font-style: italic"><span style="color: #9A1900">        Nil =&gt; 0</span></span>
<span style="color: #000000">00100:</span> <span style="font-style: italic"><span style="color: #9A1900">      | Cons(hd, tl) =&gt; hd + sum(tl)</span></span>
<span style="color: #000000">00101:</span> 
<span style="color: #000000">00102:</span> <span style="font-style: italic"><span style="color: #9A1900">fun reverse (acceptor : List) : List =</span></span>
<span style="color: #000000">00103:</span> <span style="font-style: italic"><span style="color: #9A1900">    let fun reverseAux (acceptor : List, result : List) =</span></span>
<span style="color: #000000">00104:</span> <span style="font-style: italic"><span style="color: #9A1900">            case acceptor of</span></span>
<span style="color: #000000">00105:</span> <span style="font-style: italic"><span style="color: #9A1900">                Nil =&gt; result</span></span>
<span style="color: #000000">00106:</span> <span style="font-style: italic"><span style="color: #9A1900">              | Cons(hd, tl) =&gt; reverseAux(tl, Cons(hd,result))</span></span>
<span style="color: #000000">00107:</span> <span style="font-style: italic"><span style="color: #9A1900">    in</span></span>
<span style="color: #000000">00108:</span> <span style="font-style: italic"><span style="color: #9A1900">        reverseAux (acceptor, Nil)</span></span>
<span style="color: #000000">00109:</span> <span style="font-style: italic"><span style="color: #9A1900">    end</span></span>
<span style="color: #000000">00110:</span> 
<span style="color: #000000">00111:</span> <span style="font-style: italic"><span style="color: #9A1900">fun main () : unit =</span></span>
<span style="color: #000000">00112:</span> <span style="font-style: italic"><span style="color: #9A1900">    let</span></span>
<span style="color: #000000">00113:</span> <span style="font-style: italic"><span style="color: #9A1900">        val testList = Cons(1, Cons(2, Cons(3, Nil)))</span></span>
<span style="color: #000000">00114:</span> <span style="font-style: italic"><span style="color: #9A1900">        val _ = print(toString(testList) ^ "\n")</span></span>
<span style="color: #000000">00115:</span> <span style="font-style: italic"><span style="color: #9A1900">        val _ = print(Int.toString(sum(testList)) ^ "\n")</span></span>
<span style="color: #000000">00116:</span> <span style="font-style: italic"><span style="color: #9A1900">        val _ = print(toString(copy(testList)) ^ "\n")</span></span>
<span style="color: #000000">00117:</span> <span style="font-style: italic"><span style="color: #9A1900">        val _ = print(toString(reverse(testList)) ^ "\n")</span></span>
<span style="color: #000000">00118:</span> <span style="font-style: italic"><span style="color: #9A1900">    in</span></span>
<span style="color: #000000">00119:</span> <span style="font-style: italic"><span style="color: #9A1900">        ()</span></span>
<span style="color: #000000">00120:</span> <span style="font-style: italic"><span style="color: #9A1900">    end</span></span>
<span style="color: #000000">00121:</span> 
<span style="color: #000000">00122:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00123:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00124:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide005">A Linked List: External Iterator</a></span><span style="font-weight: normal"><a href="class-10-005.html"> [5/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          External iterators must be careful if the collection is mutable.
        </p>
        <p xmlns="">
          The important part here is how <code>MutListObj</code>
          and <code>ListIterator</code> coordinate on
          <code>changeCount</code>.
        </p>
        <p xmlns="">
          The example looks <q>unusual</q> because
          <code>MutList</code> is coded using the immutable
          <code>List</code> class.
        </p>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/iterator/listfour/Main_java.html">file:iterator/listfour/Main.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/iterator/listfour/Main.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/iterator/listfour/Main.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/iterator/listfour/Main.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> iterator<span style="color: #990000">.</span>listfour<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>NoSuchElementException<span style="color: #990000">;</span>
<span style="color: #000000">00003:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>ConcurrentModificationException<span style="color: #990000">;</span>
<span style="color: #000000">00004:</span>   
<span style="color: #000000">00005:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00006:</span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">MutList</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00007:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00008:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">insert</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> i<span style="color: #990000">);</span> <span style="font-style: italic"><span style="color: #9A1900">// insert i at head of list</span></span>
<span style="color: #000000">00009:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">delete</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> i<span style="color: #990000">);</span> <span style="font-style: italic"><span style="color: #9A1900">// delete first occurence of i in the list</span></span>
<span style="color: #000000">00010:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00011:</span> 
<span style="color: #000000">00012:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00013:</span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">Iterator</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00014:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">boolean</span> <span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00015:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00016:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00017:</span> 
<span style="color: #000000">00018:</span> <span style="font-style: italic"><span style="color: #9A1900">/* public */</span></span>
<span style="color: #000000">00019:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">MutListF</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00020:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #000000">MutListF</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00021:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">MutList</span> <span style="font-weight: bold"><span style="color: #000000">newI</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00022:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">MutListObj</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00023:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00024:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00025:</span> 
<span style="color: #000000">00026:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">MutListObj</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> MutList<span style="color: #990000">,</span> Changeable <span style="color: #FF0000">{</span>
<span style="color: #000000">00027:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> List _l <span style="color: #990000">=</span> ListF<span style="color: #990000">.</span>nil<span style="color: #990000">;</span>
<span style="color: #000000">00028:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #009900">int</span> _changeCount <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
<span style="color: #000000">00029:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">changeCount</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _changeCount<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00030:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00031:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">();</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00032:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">insert</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00033:</span>     _changeCount<span style="color: #990000">++;</span>
<span style="color: #000000">00034:</span>     _l <span style="color: #990000">=</span> _l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">insert</span></span><span style="color: #990000">(</span>i<span style="color: #990000">);</span>
<span style="color: #000000">00035:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00036:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">delete</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00037:</span>     _changeCount<span style="color: #990000">++;</span>
<span style="color: #000000">00038:</span>     _l <span style="color: #990000">=</span> _l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">delete</span></span><span style="color: #990000">(</span>i<span style="color: #990000">);</span>
<span style="color: #000000">00039:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00040:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00041:</span> 
<span style="color: #000000">00042:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00043:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00044:</span> <span style="font-style: italic"><span style="color: #9A1900"> * Immutable List classes.</span></span>
<span style="color: #000000">00045:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00046:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00047:</span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">Changeable</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00048:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">changeCount</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00049:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00050:</span> 
<span style="color: #000000">00051:</span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">List</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00052:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">(</span><span style="color: #008080">Changeable</span> parent<span style="color: #990000">);</span>
<span style="color: #000000">00053:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">List</span> <span style="font-weight: bold"><span style="color: #000000">insert</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> i<span style="color: #990000">);</span>
<span style="color: #000000">00054:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">List</span> <span style="font-weight: bold"><span style="color: #000000">delete</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> i<span style="color: #990000">);</span>
<span style="color: #000000">00055:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00056:</span> 
<span style="color: #000000">00057:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">ListF</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00058:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #000000">ListF</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00059:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">List</span> nil <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Nil</span></span><span style="color: #990000">();</span> <span style="font-style: italic"><span style="color: #9A1900">/* Singleton */</span></span>
<span style="color: #000000">00060:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">List</span> <span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="font-style: italic"><span style="color: #9A1900">/* Factory */</span></span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00061:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Cons</span></span><span style="color: #990000">(</span>hd<span style="color: #990000">,</span> tl<span style="color: #990000">);</span>
<span style="color: #000000">00062:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00063:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00064:</span> 
<span style="color: #000000">00065:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Nil</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> List <span style="color: #FF0000">{</span>
<span style="color: #000000">00066:</span>   <span style="font-weight: bold"><span style="color: #000000">Nil</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00067:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #FF0000">"nil"</span><span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00068:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">(</span><span style="color: #008080">Changeable</span> parent<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00069:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">NullIterator</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00070:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00071:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">List</span> <span style="font-weight: bold"><span style="color: #000000">insert</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00072:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span>i<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00073:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00074:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">List</span> <span style="font-weight: bold"><span style="color: #000000">delete</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00075:</span>     <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">NoSuchElementException</span></span><span style="color: #990000">();</span> 
<span style="color: #000000">00076:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00077:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00078:</span> 
<span style="color: #000000">00079:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Cons</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> List <span style="color: #FF0000">{</span>
<span style="color: #000000">00080:</span>   <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #009900">int</span> _hd<span style="color: #990000">;</span>
<span style="color: #000000">00081:</span>   <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> List _tl<span style="color: #990000">;</span>
<span style="color: #000000">00082:</span>   <span style="font-weight: bold"><span style="color: #000000">Cons</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> hd<span style="color: #990000">,</span> <span style="color: #008080">List</span> tl<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> _hd <span style="color: #990000">=</span> hd<span style="color: #990000">;</span> _tl <span style="color: #990000">=</span> tl<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00083:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _hd <span style="color: #990000">+</span> <span style="color: #FF0000">"::"</span> <span style="color: #990000">+</span> _tl<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">();</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00084:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">(</span><span style="color: #008080">Changeable</span> parent<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00085:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">ListIterator</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">,</span> parent<span style="color: #990000">);</span>
<span style="color: #000000">00086:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00087:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">List</span> <span style="font-weight: bold"><span style="color: #000000">insert</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00088:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span>i<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00089:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00090:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">List</span> <span style="font-weight: bold"><span style="color: #000000">delete</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00091:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>_hd <span style="color: #990000">==</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00092:</span>       <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _tl<span style="color: #990000">;</span>
<span style="color: #000000">00093:</span>     <span style="color: #FF0000">}</span> <span style="font-weight: bold"><span style="color: #0000FF">else</span></span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00094:</span>       <span style="color: #008080">List</span> new_tl <span style="color: #990000">=</span> _tl<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">delete</span></span><span style="color: #990000">(</span>i<span style="color: #990000">);</span>
<span style="color: #000000">00095:</span>       <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span>_hd<span style="color: #990000">,</span> new_tl<span style="color: #990000">);</span>
<span style="color: #000000">00096:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00097:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00098:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00099:</span> 
<span style="color: #000000">00100:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">NullIterator</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Iterator <span style="color: #FF0000">{</span>
<span style="color: #000000">00101:</span>   <span style="font-weight: bold"><span style="color: #000000">NullIterator</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00102:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">boolean</span> <span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">false</span></span><span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00103:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">NoSuchElementException</span></span><span style="color: #990000">();</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00104:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00105:</span> 
<span style="color: #000000">00106:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">ListIterator</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Iterator <span style="color: #FF0000">{</span>
<span style="color: #000000">00107:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> List _node<span style="color: #990000">;</span>
<span style="color: #000000">00108:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> Changeable _parent<span style="color: #990000">;</span>
<span style="color: #000000">00109:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #009900">int</span> _changeCount<span style="color: #990000">;</span> 
<span style="color: #000000">00110:</span>   <span style="font-weight: bold"><span style="color: #000000">ListIterator</span></span><span style="color: #990000">(</span><span style="color: #008080">List</span> node<span style="color: #990000">,</span> <span style="color: #008080">Changeable</span> parent<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00111:</span>     _node <span style="color: #990000">=</span> node<span style="color: #990000">;</span>
<span style="color: #000000">00112:</span>     _parent <span style="color: #990000">=</span> parent<span style="color: #990000">;</span>
<span style="color: #000000">00113:</span>     _changeCount <span style="color: #990000">=</span> _parent<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">changeCount</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00114:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00115:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">boolean</span> <span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00116:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>_changeCount <span style="color: #990000">!=</span> _parent<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">changeCount</span></span><span style="color: #990000">())</span>
<span style="color: #000000">00117:</span>       <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">ConcurrentModificationException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00118:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _node <span style="color: #990000">!=</span> ListF<span style="color: #990000">.</span>nil<span style="color: #990000">;</span>
<span style="color: #000000">00119:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00120:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00121:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>_changeCount <span style="color: #990000">!=</span> _parent<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">changeCount</span></span><span style="color: #990000">())</span>
<span style="color: #000000">00122:</span>       <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">ConcurrentModificationException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00123:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(!</span> <span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">())</span>
<span style="color: #000000">00124:</span>       <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">NoSuchElementException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00125:</span>     <span style="color: #009900">int</span> result <span style="color: #990000">=</span> <span style="color: #990000">((</span>Cons<span style="color: #990000">)</span>_node<span style="color: #990000">).</span>_hd<span style="color: #990000">;</span>
<span style="color: #000000">00126:</span>     _node <span style="color: #990000">=</span> <span style="color: #990000">((</span>Cons<span style="color: #990000">)</span>_node<span style="color: #990000">).</span>_tl<span style="color: #990000">;</span>
<span style="color: #000000">00127:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> result<span style="color: #990000">;</span>
<span style="color: #000000">00128:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00129:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00130:</span> 
<span style="color: #000000">00131:</span> <span style="font-style: italic"><span style="color: #9A1900">/*</span></span>
<span style="color: #000000">00132:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00133:</span> <span style="font-style: italic"><span style="color: #9A1900"> * A test case.</span></span>
<span style="color: #000000">00134:</span> <span style="font-style: italic"><span style="color: #9A1900"> *************************************************************************</span></span>
<span style="color: #000000">00135:</span> <span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="color: #000000">00136:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Main</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00137:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">(</span>String<span style="color: #990000">[]</span> args<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00138:</span>     <span style="color: #008080">MutList</span> test <span style="color: #990000">=</span> MutListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">newI</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00139:</span>     test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">insert</span></span><span style="color: #990000">(</span><span style="color: #993399">3</span><span style="color: #990000">);</span>
<span style="color: #000000">00140:</span>     test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">insert</span></span><span style="color: #990000">(</span><span style="color: #993399">2</span><span style="color: #990000">);</span>
<span style="color: #000000">00141:</span>     test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">insert</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">);</span>
<span style="color: #000000">00142:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>test<span style="color: #990000">);</span>
<span style="color: #000000">00143:</span> 
<span style="color: #000000">00144:</span>     <span style="color: #009900">int</span> sum<span style="color: #990000">=</span><span style="color: #993399">0</span><span style="color: #990000">;</span>
<span style="color: #000000">00145:</span>     <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="color: #008080">Iterator</span> i <span style="color: #990000">=</span> test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">();</span> i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">();</span> <span style="color: #990000">)</span>
<span style="color: #000000">00146:</span>       sum <span style="color: #990000">+=</span> i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00147:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>sum<span style="color: #990000">);</span>
<span style="color: #000000">00148:</span> 
<span style="color: #000000">00149:</span>     <span style="color: #008080">List</span> rev<span style="color: #990000">=</span>ListF<span style="color: #990000">.</span>nil<span style="color: #990000">;</span>
<span style="color: #000000">00150:</span>     <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="color: #008080">Iterator</span> i <span style="color: #990000">=</span> test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">();</span> i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">();</span> <span style="color: #990000">)</span>
<span style="color: #000000">00151:</span>       rev <span style="color: #990000">=</span> ListF<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">cons</span></span><span style="color: #990000">(</span>i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">(),</span>rev<span style="color: #990000">);</span>
<span style="color: #000000">00152:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span>rev<span style="color: #990000">);</span>
<span style="color: #000000">00153:</span> 
<span style="color: #000000">00154:</span>     <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="color: #008080">Iterator</span> i <span style="color: #990000">=</span> test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">newIterator</span></span><span style="color: #990000">();</span> i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">();</span> <span style="color: #990000">)</span>
<span style="color: #000000">00155:</span>       test<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">insert</span></span><span style="color: #990000">(</span><span style="color: #993399">4</span><span style="color: #990000">);</span>
<span style="color: #000000">00156:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00157:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00158:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide006">A Tree: Functions over Composite</a></span><span style="font-weight: normal"><a href="class-10-006.html"> [6/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          Iterators over a composite have limited value, because they
          treat every type of node the same.
        </p>
        <p xmlns="">
          How to write a function over a composite?
        </p>
        <p xmlns="">
          There are two things that vary here: which function and
          which type of node.
        </p>
        <ul xmlns="">
          <li>
            <b>interpreter</b>:
            <ul>
              <li>
                Method in each node for each function (as usual).
              </li>
              <li>
                <em>Hard to add new functions</em>; easy to add new node types.
              </li>
              <li>
                This is the "normal" OO style for a composite.
              </li>
            </ul>
          </li>
          <li>
            <b>typecase</b>:
            <ul>
              <li>
                One static class per function; define a static helper
                method for each node type; use <code>instanceOf</code>
                and casting to determine node type.
              </li>
              <li>
                <em>Hard to add new node types</em>; easy to add new functions.
              </li>
              <li>
                Class names and attributes must be public.
              </li>
              <li>
                Languages such as ML and
                <a xmlns="http://www.w3.org/1999/xhtml" href="http://www.scala-lang.org/">scala</a>
                have support for typecase, making it more
                attractive.
              </li>
            </ul>
          </li>
          <li>
            <b>visitor</b>:
            <ul>
              <li>
                One object class per function; define an object method
                for each node type; use double dispatch.
              </li>
              <li>
                <em>Hard to add new node types</em>; easy to add new functions.
              </li>
              <li>
                Class names and attributes may be private.
              </li>
            </ul>
          </li>
        </ul>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide007">A Tree: Recall Composite</a></span><span style="font-weight: normal"><a href="class-10-007.html"> [7/25] </a></span></td></tr></table><p> </p>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/enumeration/Expr_java.html">file:enumeration/Expr.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/enumeration/Expr.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/enumeration/Expr.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/enumeration/Expr.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> enumeration<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> 
<span style="color: #000000">00003:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">Expr</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00004:</span>   <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">printPostorder</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00005:</span>   <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">evaluate</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00006:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00007:</span> 
<span style="color: #000000">00008:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Const</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Expr <span style="color: #FF0000">{</span>
<span style="color: #000000">00009:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #009900">int</span> _v<span style="color: #990000">;</span>
<span style="color: #000000">00010:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> v<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00011:</span>     _v <span style="color: #990000">=</span> v<span style="color: #990000">;</span>
<span style="color: #000000">00012:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00013:</span> 
<span style="color: #000000">00014:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">evaluate</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00015:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _v<span style="color: #990000">;</span>
<span style="color: #000000">00016:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00017:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">printPostorder</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00018:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">print</span></span><span style="color: #990000">(</span>_v <span style="color: #990000">+</span> <span style="color: #FF0000">" "</span><span style="color: #990000">);</span>
<span style="color: #000000">00019:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00020:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00021:</span> 
<span style="color: #000000">00022:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">BinOp</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Expr <span style="color: #FF0000">{</span>
<span style="color: #000000">00023:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> Expr _l<span style="color: #990000">;</span>
<span style="color: #000000">00024:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> Expr _r<span style="color: #990000">;</span>
<span style="color: #000000">00025:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> Op _op<span style="color: #990000">;</span>
<span style="color: #000000">00026:</span> 
<span style="color: #000000">00027:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span><span style="color: #990000">(</span><span style="color: #008080">Expr</span> l<span style="color: #990000">,</span> <span style="color: #008080">Op</span> op<span style="color: #990000">,</span> <span style="color: #008080">Expr</span> r<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00028:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">((</span>l <span style="color: #990000">==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">)</span> <span style="color: #990000">||</span> <span style="color: #990000">(</span>op <span style="color: #990000">==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">)</span> <span style="color: #990000">||</span> <span style="color: #990000">(</span>r <span style="color: #990000">==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">))</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00029:</span>       <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">IllegalArgumentException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00030:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00031:</span>     _op <span style="color: #990000">=</span> op<span style="color: #990000">;</span>
<span style="color: #000000">00032:</span>     _l <span style="color: #990000">=</span> l<span style="color: #990000">;</span>
<span style="color: #000000">00033:</span>     _r <span style="color: #990000">=</span> r<span style="color: #990000">;</span>
<span style="color: #000000">00034:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00035:</span> 
<span style="color: #000000">00036:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">evaluate</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00037:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _op<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">eval</span></span><span style="color: #990000">(</span>_l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">evaluate</span></span><span style="color: #990000">(),</span> _r<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">evaluate</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00038:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00039:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">printPostorder</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00040:</span>     _l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">printPostorder</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00041:</span>     _r<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">printPostorder</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00042:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">print</span></span><span style="color: #990000">(</span>_op <span style="color: #990000">+</span> <span style="color: #FF0000">" "</span><span style="color: #990000">);</span>
<span style="color: #000000">00043:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00044:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00045:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/enumeration/Op_java.html">file:enumeration/Op.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/enumeration/Op.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/enumeration/Op.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/enumeration/Op.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> enumeration<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> 
<span style="color: #000000">00003:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">abstract</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Op</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00004:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> String _name<span style="color: #990000">;</span>
<span style="color: #000000">00005:</span>   <span style="font-weight: bold"><span style="color: #000000">Op</span></span><span style="color: #990000">(</span><span style="color: #008080">String</span> name<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> _name <span style="color: #990000">=</span> name<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00006:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">String</span> <span style="font-weight: bold"><span style="color: #000000">toString</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _name<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00007:</span> 
<span style="color: #000000">00008:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">abstract</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">eval</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> x<span style="color: #990000">,</span> <span style="color: #009900">int</span> y<span style="color: #990000">);</span>
<span style="color: #000000">00009:</span> 
<span style="color: #000000">00010:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">Op</span> ADD <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">OpAdd</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00011:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">Op</span> SUB <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">OpSub</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00012:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">Op</span> MUL <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">OpMul</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00013:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">Op</span> DIV <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">OpDiv</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00014:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00015:</span> 
<span style="color: #000000">00016:</span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">OpAdd</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> Op <span style="color: #FF0000">{</span>
<span style="color: #000000">00017:</span>   <span style="font-weight: bold"><span style="color: #000000">OpAdd</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>  <span style="font-weight: bold"><span style="color: #0000FF">super</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"+"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00018:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">eval</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> x<span style="color: #990000">,</span> <span style="color: #009900">int</span> y<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> x<span style="color: #990000">+</span>y<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00019:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00020:</span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">OpSub</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> Op <span style="color: #FF0000">{</span>
<span style="color: #000000">00021:</span>   <span style="font-weight: bold"><span style="color: #000000">OpSub</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>  <span style="font-weight: bold"><span style="color: #0000FF">super</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"-"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00022:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">eval</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> x<span style="color: #990000">,</span> <span style="color: #009900">int</span> y<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> x<span style="color: #990000">-</span>y<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00023:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00024:</span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">OpMul</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> Op <span style="color: #FF0000">{</span>
<span style="color: #000000">00025:</span>   <span style="font-weight: bold"><span style="color: #000000">OpMul</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>  <span style="font-weight: bold"><span style="color: #0000FF">super</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"*"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00026:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">eval</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> x<span style="color: #990000">,</span> <span style="color: #009900">int</span> y<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> x<span style="color: #990000">*</span>y<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00027:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00028:</span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">OpDiv</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> Op <span style="color: #FF0000">{</span>
<span style="color: #000000">00029:</span>   <span style="font-weight: bold"><span style="color: #000000">OpDiv</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>  <span style="font-weight: bold"><span style="color: #0000FF">super</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"/"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00030:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">eval</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> x<span style="color: #990000">,</span> <span style="color: #009900">int</span> y<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> x<span style="color: #990000">/</span>y<span style="color: #990000">;</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00031:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00032:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide008">A Tree: Typecase</a></span><span style="font-weight: normal"><a href="class-10-008.html"> [8/25] </a></span></td></tr></table><p> </p>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/visitor/typecase/Main_java.html">file:visitor/typecase/Main.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/visitor/typecase/Main.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/visitor/typecase/Main.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/visitor/typecase/Main.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> visitor<span style="color: #990000">.</span>typecase<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> enumeration<span style="color: #990000">.</span>Op<span style="color: #990000">;</span>
<span style="color: #000000">00003:</span> 
<span style="color: #000000">00004:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Main</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00005:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span> <span style="color: #990000">(</span>String<span style="color: #990000">[]</span> args<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00006:</span>     <span style="color: #008080">Expr</span> one <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">);</span>
<span style="color: #000000">00007:</span>     <span style="color: #008080">Expr</span> onePtwo <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">),</span> Op<span style="color: #990000">.</span>ADD<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">2</span><span style="color: #990000">));</span>
<span style="color: #000000">00008:</span>     <span style="color: #008080">Expr</span> threeMfour <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">3</span><span style="color: #990000">),</span> Op<span style="color: #990000">.</span>MUL<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">4</span><span style="color: #990000">));</span>
<span style="color: #000000">00009:</span>     <span style="color: #008080">Expr</span> m <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span> <span style="color: #990000">(</span>onePtwo<span style="color: #990000">,</span> Op<span style="color: #990000">.</span>SUB<span style="color: #990000">,</span> threeMfour<span style="color: #990000">);</span>
<span style="color: #000000">00010:</span>     <span style="color: #008080">Expr</span> n <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span> <span style="color: #990000">(</span>m<span style="color: #990000">,</span> Op<span style="color: #990000">.</span>DIV<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">5</span><span style="color: #990000">));</span>
<span style="color: #000000">00011:</span>     
<span style="color: #000000">00012:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span> <span style="color: #990000">(</span>PostorderPrint<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span>n<span style="color: #990000">));</span>
<span style="color: #000000">00013:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span> <span style="color: #990000">(</span><span style="color: #FF0000">"Value: "</span> <span style="color: #990000">+</span> Eval<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span>n<span style="color: #990000">));</span>
<span style="color: #000000">00014:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00015:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00016:</span> 
<span style="color: #000000">00017:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">PostorderPrint</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00018:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #000000">PostorderPrint</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00019:</span>   <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #008080">StringBuilder</span> b <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">StringBuilder</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00020:</span>   <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #008080">StringBuilder</span> <span style="font-weight: bold"><span style="color: #000000">runConst</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> c<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00021:</span>     b<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">append</span></span><span style="color: #990000">(</span>c <span style="color: #990000">+</span> <span style="color: #FF0000">" "</span><span style="color: #990000">);</span>
<span style="color: #000000">00022:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> b<span style="color: #990000">;</span>
<span style="color: #000000">00023:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00024:</span>   <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #008080">StringBuilder</span> <span style="font-weight: bold"><span style="color: #000000">runBinOp</span></span><span style="color: #990000">(</span><span style="color: #008080">Expr</span> l<span style="color: #990000">,</span> <span style="color: #008080">Op</span> op<span style="color: #990000">,</span> <span style="color: #008080">Expr</span> r<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00025:</span>     <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span>l<span style="color: #990000">);</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span>r<span style="color: #990000">);</span> b<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">append</span></span><span style="color: #990000">(</span>op <span style="color: #990000">+</span> <span style="color: #FF0000">" "</span><span style="color: #990000">);</span>
<span style="color: #000000">00026:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> b<span style="color: #990000">;</span>
<span style="color: #000000">00027:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00028:</span>   <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">StringBuilder</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span><span style="color: #008080">Expr</span> e<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00029:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>e <span style="color: #008080">instanceof</span> BinOp<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00030:</span>       <span style="color: #008080">BinOp</span> x <span style="color: #990000">=</span> <span style="color: #990000">(</span>BinOp<span style="color: #990000">)</span> e<span style="color: #990000">;</span>
<span style="color: #000000">00031:</span>       <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #000000">runBinOp</span></span><span style="color: #990000">(</span>x<span style="color: #990000">.</span>l<span style="color: #990000">,</span> x<span style="color: #990000">.</span>op<span style="color: #990000">,</span> x<span style="color: #990000">.</span>r<span style="color: #990000">);</span>
<span style="color: #000000">00032:</span>     <span style="color: #FF0000">}</span> <span style="font-weight: bold"><span style="color: #0000FF">else</span></span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00033:</span>       <span style="color: #008080">Const</span> x <span style="color: #990000">=</span> <span style="color: #990000">(</span>Const<span style="color: #990000">)</span> e<span style="color: #990000">;</span>
<span style="color: #000000">00034:</span>       <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #000000">runConst</span></span><span style="color: #990000">(</span>x<span style="color: #990000">.</span>c<span style="color: #990000">);</span>
<span style="color: #000000">00035:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00036:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00037:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00038:</span> 
<span style="color: #000000">00039:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Eval</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00040:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #000000">Eval</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{}</span>
<span style="color: #000000">00041:</span>   <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #008080">Integer</span> <span style="font-weight: bold"><span style="color: #000000">runConst</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> c<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00042:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> c<span style="color: #990000">;</span>
<span style="color: #000000">00043:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00044:</span>   <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #008080">Integer</span> <span style="font-weight: bold"><span style="color: #000000">runBinOp</span></span><span style="color: #990000">(</span><span style="color: #008080">Expr</span> l<span style="color: #990000">,</span> <span style="color: #008080">Op</span> op<span style="color: #990000">,</span> <span style="color: #008080">Expr</span> r<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00045:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> op<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">eval</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span>l<span style="color: #990000">),</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span>r<span style="color: #990000">));</span>
<span style="color: #000000">00046:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00047:</span>   <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Integer</span> <span style="font-weight: bold"><span style="color: #000000">run</span></span><span style="color: #990000">(</span><span style="color: #008080">Expr</span> e<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00048:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>e <span style="color: #008080">instanceof</span> BinOp<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00049:</span>       <span style="color: #008080">BinOp</span> x <span style="color: #990000">=</span> <span style="color: #990000">(</span>BinOp<span style="color: #990000">)</span> e<span style="color: #990000">;</span>
<span style="color: #000000">00050:</span>       <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #000000">runBinOp</span></span><span style="color: #990000">(</span>x<span style="color: #990000">.</span>l<span style="color: #990000">,</span> x<span style="color: #990000">.</span>op<span style="color: #990000">,</span> x<span style="color: #990000">.</span>r<span style="color: #990000">);</span>
<span style="color: #000000">00051:</span>     <span style="color: #FF0000">}</span> <span style="font-weight: bold"><span style="color: #0000FF">else</span></span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00052:</span>       <span style="color: #008080">Const</span> x <span style="color: #990000">=</span> <span style="color: #990000">(</span>Const<span style="color: #990000">)</span> e<span style="color: #990000">;</span>
<span style="color: #000000">00053:</span>       <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #000000">runConst</span></span><span style="color: #990000">(</span>x<span style="color: #990000">.</span>c<span style="color: #990000">);</span>
<span style="color: #000000">00054:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00055:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00056:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00057:</span> 
<span style="color: #000000">00058:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/visitor/typecase/Expr_java.html">file:visitor/typecase/Expr.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/visitor/typecase/Expr.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/visitor/typecase/Expr.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/visitor/typecase/Expr.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> visitor<span style="color: #990000">.</span>typecase<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> enumeration<span style="color: #990000">.</span>Op<span style="color: #990000">;</span>
<span style="color: #000000">00003:</span> 
<span style="color: #000000">00004:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">Expr</span> <span style="color: #FF0000">{</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00005:</span> 
<span style="color: #000000">00006:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Const</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Expr <span style="color: #FF0000">{</span>
<span style="color: #000000">00007:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #009900">int</span> c<span style="color: #990000">;</span>
<span style="color: #000000">00008:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> c<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00009:</span>     <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>c <span style="color: #990000">=</span> c<span style="color: #990000">;</span>
<span style="color: #000000">00010:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00011:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00012:</span> 
<span style="color: #000000">00013:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">BinOp</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Expr <span style="color: #FF0000">{</span>
<span style="color: #000000">00014:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">Expr</span> l<span style="color: #990000">;</span>
<span style="color: #000000">00015:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">Expr</span> r<span style="color: #990000">;</span>
<span style="color: #000000">00016:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #008080">Op</span> op<span style="color: #990000">;</span>
<span style="color: #000000">00017:</span> 
<span style="color: #000000">00018:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span><span style="color: #990000">(</span><span style="color: #008080">Expr</span> l<span style="color: #990000">,</span> <span style="color: #008080">Op</span> op<span style="color: #990000">,</span> <span style="color: #008080">Expr</span> r<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00019:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">((</span>l <span style="color: #990000">==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">)</span> <span style="color: #990000">||</span> <span style="color: #990000">(</span>op <span style="color: #990000">==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">)</span> <span style="color: #990000">||</span> <span style="color: #990000">(</span>r <span style="color: #990000">==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">))</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00020:</span>       <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">IllegalArgumentException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00021:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00022:</span>     <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>op <span style="color: #990000">=</span> op<span style="color: #990000">;</span>
<span style="color: #000000">00023:</span>     <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>l <span style="color: #990000">=</span> l<span style="color: #990000">;</span>
<span style="color: #000000">00024:</span>     <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>r <span style="color: #990000">=</span> r<span style="color: #990000">;</span>
<span style="color: #000000">00025:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00026:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00027:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide009">A Tree: Visitor</a></span><span style="font-weight: normal"><a href="class-10-009.html"> [9/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          Visitor is a "cleaned up" version of typecase.
        </p>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/visitor/expr/ExprVisitor_java.html">file:visitor/expr/ExprVisitor.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/visitor/expr/ExprVisitor.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/visitor/expr/ExprVisitor.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/visitor/expr/ExprVisitor.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> visitor<span style="color: #990000">.</span>expr<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> enumeration<span style="color: #990000">.</span>Op<span style="color: #990000">;</span>
<span style="color: #000000">00003:</span> 
<span style="color: #000000">00004:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">ExprVisitor</span><span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00005:</span>   <span style="color: #008080">T</span> <span style="font-weight: bold"><span style="color: #000000">visitConst</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> c<span style="color: #990000">);</span>
<span style="color: #000000">00006:</span>   <span style="color: #008080">T</span> <span style="font-weight: bold"><span style="color: #000000">visitBinOp</span></span><span style="color: #990000">(</span><span style="color: #008080">Expr</span> l<span style="color: #990000">,</span> <span style="color: #008080">Op</span> op<span style="color: #990000">,</span> <span style="color: #008080">Expr</span> r<span style="color: #990000">);</span>
<span style="color: #000000">00007:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00008:</span> 
<span style="color: #000000">00009:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/visitor/expr/Main_java.html">file:visitor/expr/Main.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/visitor/expr/Main.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/visitor/expr/Main.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/visitor/expr/Main.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> visitor<span style="color: #990000">.</span>expr<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> enumeration<span style="color: #990000">.</span>Op<span style="color: #990000">;</span>
<span style="color: #000000">00003:</span> 
<span style="color: #000000">00004:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Main</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00005:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span> <span style="color: #990000">(</span>String<span style="color: #990000">[]</span> args<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00006:</span>     <span style="color: #008080">Expr</span> one <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">);</span>
<span style="color: #000000">00007:</span>     <span style="color: #008080">Expr</span> onePtwo <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">),</span> Op<span style="color: #990000">.</span>ADD<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">2</span><span style="color: #990000">));</span>
<span style="color: #000000">00008:</span>     <span style="color: #008080">Expr</span> threeMfour <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">3</span><span style="color: #990000">),</span> Op<span style="color: #990000">.</span>MUL<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">4</span><span style="color: #990000">));</span>
<span style="color: #000000">00009:</span>     <span style="color: #008080">Expr</span> m <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span> <span style="color: #990000">(</span>onePtwo<span style="color: #990000">,</span> Op<span style="color: #990000">.</span>SUB<span style="color: #990000">,</span> threeMfour<span style="color: #990000">);</span>
<span style="color: #000000">00010:</span>     <span style="color: #008080">Expr</span> n <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span> <span style="color: #990000">(</span>m<span style="color: #990000">,</span> Op<span style="color: #990000">.</span>DIV<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">5</span><span style="color: #990000">));</span>
<span style="color: #000000">00011:</span>     
<span style="color: #000000">00012:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span> <span style="color: #990000">(</span>n<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">PostorderToString</span></span><span style="color: #990000">()));</span>
<span style="color: #000000">00013:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span> <span style="color: #990000">(</span><span style="color: #FF0000">"Value: "</span> <span style="color: #990000">+</span> n<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Eval</span></span><span style="color: #990000">()));</span>
<span style="color: #000000">00014:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00015:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00016:</span> 
<span style="color: #000000">00017:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Eval</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> ExprVisitor<span style="color: #990000">&lt;</span>Integer<span style="color: #990000">&gt;</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00018:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Integer</span> <span style="font-weight: bold"><span style="color: #000000">visitConst</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> c<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00019:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> c<span style="color: #990000">;</span>
<span style="color: #000000">00020:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00021:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Integer</span> <span style="font-weight: bold"><span style="color: #000000">visitBinOp</span></span><span style="color: #990000">(</span><span style="color: #008080">Expr</span> l<span style="color: #990000">,</span> <span style="color: #008080">Op</span> op<span style="color: #990000">,</span> <span style="color: #008080">Expr</span> r<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00022:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> op<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">eval</span></span><span style="color: #990000">(</span>l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">),</span> r<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">));</span>
<span style="color: #000000">00023:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00024:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00025:</span> 
<span style="color: #000000">00026:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">PostorderToString</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> ExprVisitor<span style="color: #990000">&lt;</span>StringBuilder<span style="color: #990000">&gt;</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00027:</span>   <span style="color: #008080">StringBuilder</span> b <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">StringBuilder</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00028:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">StringBuilder</span> <span style="font-weight: bold"><span style="color: #000000">visitConst</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> c<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00029:</span>     b<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">append</span></span> <span style="color: #990000">(</span>c <span style="color: #990000">+</span> <span style="color: #FF0000">" "</span><span style="color: #990000">);</span>
<span style="color: #000000">00030:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> b<span style="color: #990000">;</span>
<span style="color: #000000">00031:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00032:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">StringBuilder</span> <span style="font-weight: bold"><span style="color: #000000">visitBinOp</span></span><span style="color: #990000">(</span><span style="color: #008080">Expr</span> l<span style="color: #990000">,</span> <span style="color: #008080">Op</span> op<span style="color: #990000">,</span> <span style="color: #008080">Expr</span> r<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00033:</span>     l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span> r<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span> b<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">append</span></span> <span style="color: #990000">(</span>op <span style="color: #990000">+</span> <span style="color: #FF0000">" "</span><span style="color: #990000">);</span>
<span style="color: #000000">00034:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> b<span style="color: #990000">;</span>
<span style="color: #000000">00035:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00036:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00037:</span> 
<span style="color: #000000">00038:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">PreOrderToString</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> ExprVisitor<span style="color: #990000">&lt;</span>StringBuilder<span style="color: #990000">&gt;</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00039:</span>   <span style="color: #008080">StringBuilder</span> b <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">StringBuilder</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00040:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">StringBuilder</span> <span style="font-weight: bold"><span style="color: #000000">visitConst</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> c<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00041:</span>     b<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">append</span></span> <span style="color: #990000">(</span>c <span style="color: #990000">+</span> <span style="color: #FF0000">" "</span><span style="color: #990000">);</span>
<span style="color: #000000">00042:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> b<span style="color: #990000">;</span>
<span style="color: #000000">00043:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00044:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">StringBuilder</span> <span style="font-weight: bold"><span style="color: #000000">visitBinOp</span></span><span style="color: #990000">(</span><span style="color: #008080">Expr</span> l<span style="color: #990000">,</span> <span style="color: #008080">Op</span> op<span style="color: #990000">,</span> <span style="color: #008080">Expr</span> r<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00045:</span>     b<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">append</span></span> <span style="color: #990000">(</span>op <span style="color: #990000">+</span> <span style="color: #FF0000">" "</span><span style="color: #990000">);</span> l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span> r<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00046:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> b<span style="color: #990000">;</span>
<span style="color: #000000">00047:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00048:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00049:</span> 
<span style="color: #000000">00050:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">InOrderToString</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> ExprVisitor<span style="color: #990000">&lt;</span>StringBuilder<span style="color: #990000">&gt;</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00051:</span>   <span style="color: #008080">StringBuilder</span> b <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">StringBuilder</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00052:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">StringBuilder</span> <span style="font-weight: bold"><span style="color: #000000">visitConst</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> c<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00053:</span>     b<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">append</span></span> <span style="color: #990000">(</span>c <span style="color: #990000">+</span> <span style="color: #FF0000">" "</span><span style="color: #990000">);</span>
<span style="color: #000000">00054:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> b<span style="color: #990000">;</span>
<span style="color: #000000">00055:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00056:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">StringBuilder</span> <span style="font-weight: bold"><span style="color: #000000">visitBinOp</span></span><span style="color: #990000">(</span><span style="color: #008080">Expr</span> l<span style="color: #990000">,</span> <span style="color: #008080">Op</span> op<span style="color: #990000">,</span> <span style="color: #008080">Expr</span> r<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00057:</span>     l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span> b<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">append</span></span> <span style="color: #990000">(</span>op <span style="color: #990000">+</span> <span style="color: #FF0000">" "</span><span style="color: #990000">);</span> r<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00058:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> b<span style="color: #990000">;</span>
<span style="color: #000000">00059:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00060:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00061:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/visitor/expr/Expr_java.html">file:visitor/expr/Expr.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/visitor/expr/Expr.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/visitor/expr/Expr.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/visitor/expr/Expr.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> visitor<span style="color: #990000">.</span>expr<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> enumeration<span style="color: #990000">.</span>Op<span style="color: #990000">;</span>
<span style="color: #000000">00003:</span> 
<span style="color: #000000">00004:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">Expr</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00005:</span>   <span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;</span> <span style="color: #008080">T</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="color: #008080">ExprVisitor&lt;T&gt;</span> v<span style="color: #990000">);</span>
<span style="color: #000000">00006:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00007:</span> 
<span style="color: #000000">00008:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Const</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Expr <span style="color: #FF0000">{</span>
<span style="color: #000000">00009:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #009900">int</span> _c<span style="color: #990000">;</span>
<span style="color: #000000">00010:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> c<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00011:</span>     _c <span style="color: #990000">=</span> c<span style="color: #990000">;</span>
<span style="color: #000000">00012:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00013:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;</span> <span style="color: #008080">T</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="color: #008080">ExprVisitor&lt;T&gt;</span> v<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00014:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> v<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">visitConst</span></span><span style="color: #990000">(</span>_c<span style="color: #990000">);</span>
<span style="color: #000000">00015:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00016:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00017:</span> 
<span style="color: #000000">00018:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">BinOp</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Expr <span style="color: #FF0000">{</span>
<span style="color: #000000">00019:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> Expr _l<span style="color: #990000">;</span>
<span style="color: #000000">00020:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> Expr _r<span style="color: #990000">;</span>
<span style="color: #000000">00021:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> Op _op<span style="color: #990000">;</span>
<span style="color: #000000">00022:</span> 
<span style="color: #000000">00023:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span><span style="color: #990000">(</span><span style="color: #008080">Expr</span> l<span style="color: #990000">,</span> <span style="color: #008080">Op</span> op<span style="color: #990000">,</span> <span style="color: #008080">Expr</span> r<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00024:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">((</span>l <span style="color: #990000">==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">)</span> <span style="color: #990000">||</span> <span style="color: #990000">(</span>op <span style="color: #990000">==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">)</span> <span style="color: #990000">||</span> <span style="color: #990000">(</span>r <span style="color: #990000">==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">))</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00025:</span>       <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">IllegalArgumentException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00026:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00027:</span>     _op <span style="color: #990000">=</span> op<span style="color: #990000">;</span>
<span style="color: #000000">00028:</span>     _l <span style="color: #990000">=</span> l<span style="color: #990000">;</span>
<span style="color: #000000">00029:</span>     _r <span style="color: #990000">=</span> r<span style="color: #990000">;</span>
<span style="color: #000000">00030:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00031:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;</span> <span style="color: #008080">T</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span><span style="color: #008080">ExprVisitor&lt;T&gt;</span> v<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00032:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> v<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">visitBinOp</span></span><span style="color: #990000">(</span>_l<span style="color: #990000">,</span> _op<span style="color: #990000">,</span> _r<span style="color: #990000">);</span>
<span style="color: #000000">00033:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00034:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00035:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide010">A Tree: External Iterator using a Stack</a></span><span style="font-weight: normal"><a href="class-10-010.html"> [10/25] </a></span></td></tr></table><p> </p>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/iterator/exprtwo/Main_java.html">file:iterator/exprtwo/Main.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/iterator/exprtwo/Main.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/iterator/exprtwo/Main.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/iterator/exprtwo/Main.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> iterator<span style="color: #990000">.</span>exprtwo<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>Iterator<span style="color: #990000">;</span>
<span style="color: #000000">00003:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> enumeration<span style="color: #990000">.</span>Op<span style="color: #990000">;</span>
<span style="color: #000000">00004:</span> 
<span style="color: #000000">00005:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Main</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00006:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span> <span style="color: #990000">(</span>String<span style="color: #990000">[]</span> args<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00007:</span>     <span style="color: #008080">AbsExpr</span> one <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">);</span>
<span style="color: #000000">00008:</span>     <span style="color: #008080">AbsExpr</span> onePtwo <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">),</span> Op<span style="color: #990000">.</span>ADD<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">2</span><span style="color: #990000">));</span>
<span style="color: #000000">00009:</span>     <span style="color: #008080">AbsExpr</span> threeMfour <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">3</span><span style="color: #990000">),</span> Op<span style="color: #990000">.</span>MUL<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">4</span><span style="color: #990000">));</span>
<span style="color: #000000">00010:</span>     <span style="color: #008080">AbsExpr</span> m <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span> <span style="color: #990000">(</span>onePtwo<span style="color: #990000">,</span> Op<span style="color: #990000">.</span>SUB<span style="color: #990000">,</span> threeMfour<span style="color: #990000">);</span>
<span style="color: #000000">00011:</span>     <span style="color: #008080">Expr</span> n <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span> <span style="color: #990000">(</span>m<span style="color: #990000">,</span> Op<span style="color: #990000">.</span>DIV<span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #993399">5</span><span style="color: #990000">));</span>
<span style="color: #000000">00012:</span>     
<span style="color: #000000">00013:</span>     <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="color: #008080">Iterator</span> i <span style="color: #990000">=</span> n<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">postorderIterator</span></span><span style="color: #990000">();</span> i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">();</span> <span style="color: #990000">)</span>
<span style="color: #000000">00014:</span>       System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">print</span></span> <span style="color: #990000">(</span>i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">()</span> <span style="color: #990000">+</span> <span style="color: #FF0000">" "</span><span style="color: #990000">);</span>
<span style="color: #000000">00015:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span> <span style="color: #990000">(</span><span style="color: #FF0000">""</span><span style="color: #990000">);</span>
<span style="color: #000000">00016:</span>     
<span style="color: #000000">00017:</span>     <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="color: #008080">Iterator</span> i <span style="color: #990000">=</span> n<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">preorderIterator</span></span><span style="color: #990000">();</span> i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">();</span> <span style="color: #990000">)</span>
<span style="color: #000000">00018:</span>       System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">print</span></span> <span style="color: #990000">(</span>i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">()</span> <span style="color: #990000">+</span> <span style="color: #FF0000">" "</span><span style="color: #990000">);</span>
<span style="color: #000000">00019:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span> <span style="color: #990000">(</span><span style="color: #FF0000">""</span><span style="color: #990000">);</span>
<span style="color: #000000">00020:</span>     
<span style="color: #000000">00021:</span>     <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span><span style="color: #008080">Iterator</span> i <span style="color: #990000">=</span> n<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">breadthIterator</span></span><span style="color: #990000">();</span> i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">();</span> <span style="color: #990000">)</span>
<span style="color: #000000">00022:</span>       System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">print</span></span> <span style="color: #990000">(</span>i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">()</span> <span style="color: #990000">+</span> <span style="color: #FF0000">" "</span><span style="color: #990000">);</span>
<span style="color: #000000">00023:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span> <span style="color: #990000">(</span><span style="color: #FF0000">""</span><span style="color: #990000">);</span>
<span style="color: #000000">00024:</span>     
<span style="color: #000000">00025:</span>     System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span> <span style="color: #990000">(</span><span style="color: #FF0000">"Value: "</span> <span style="color: #990000">+</span> n<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">evaluate</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00026:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00027:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00028:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/iterator/exprtwo/Expr_java.html">file:iterator/exprtwo/Expr.java</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/iterator/exprtwo/Expr.java">source</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-public/iterator/exprtwo/Expr.html">doc-public</a>] [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/doc-private/iterator/exprtwo/Expr.html">doc-private</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-weight: bold"><span style="color: #000080">package</span></span> iterator<span style="color: #990000">.</span>exprtwo<span style="color: #990000">;</span>
<span style="color: #000000">00002:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>Iterator<span style="color: #990000">;</span>
<span style="color: #000000">00003:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>NoSuchElementException<span style="color: #990000">;</span>
<span style="color: #000000">00004:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>List<span style="color: #990000">;</span>
<span style="color: #000000">00005:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>ArrayList<span style="color: #990000">;</span>
<span style="color: #000000">00006:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>Stack<span style="color: #990000">;</span>
<span style="color: #000000">00007:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>Set<span style="color: #990000">;</span>
<span style="color: #000000">00008:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> java<span style="color: #990000">.</span>util<span style="color: #990000">.</span>HashSet<span style="color: #990000">;</span>
<span style="color: #000000">00009:</span> <span style="font-weight: bold"><span style="color: #000080">import</span></span> enumeration<span style="color: #990000">.</span>Op<span style="color: #990000">;</span>
<span style="color: #000000">00010:</span> 
<span style="color: #000000">00011:</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">Expr</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00012:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">evaluate</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00013:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">preorderIterator</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00014:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">postorderIterator</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00015:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">breadthIterator</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00016:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00017:</span> 
<span style="color: #000000">00018:</span> <span style="font-weight: bold"><span style="color: #0000FF">abstract</span></span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">AbsExpr</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Expr <span style="color: #FF0000">{</span>
<span style="color: #000000">00019:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">abstract</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">evaluate</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00020:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">preorderIterator</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00021:</span>     <span style="color: #008080">PreorderIterator</span> i <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">PreorderIterator</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00022:</span>     i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addNode</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00023:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> i<span style="color: #990000">;</span>
<span style="color: #000000">00024:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00025:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">postorderIterator</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00026:</span>     <span style="color: #008080">PostorderIterator</span> i <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">PostorderIterator</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00027:</span>     i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addNode</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00028:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> i<span style="color: #990000">;</span>
<span style="color: #000000">00029:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00030:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Iterator</span> <span style="font-weight: bold"><span style="color: #000000">breadthIterator</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00031:</span>     <span style="color: #008080">BreadthIterator</span> i <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BreadthIterator</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00032:</span>     i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addNode</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00033:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> i<span style="color: #990000">;</span>
<span style="color: #000000">00034:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00035:</span>   <span style="font-weight: bold"><span style="color: #0000FF">abstract</span></span> <span style="color: #008080">Object</span> <span style="font-weight: bold"><span style="color: #000000">acceptPreOrder</span></span><span style="color: #990000">(</span><span style="color: #008080">PreorderIterator</span> i<span style="color: #990000">);</span>
<span style="color: #000000">00036:</span>   <span style="font-weight: bold"><span style="color: #0000FF">abstract</span></span> <span style="color: #008080">Object</span> <span style="font-weight: bold"><span style="color: #000000">acceptPostOrder</span></span><span style="color: #990000">(</span><span style="color: #008080">PostorderIterator</span> i<span style="color: #990000">);</span>
<span style="color: #000000">00037:</span>   <span style="font-weight: bold"><span style="color: #0000FF">abstract</span></span> <span style="color: #008080">Object</span> <span style="font-weight: bold"><span style="color: #000000">acceptBreadth</span></span><span style="color: #990000">(</span><span style="color: #008080">BreadthIterator</span> i<span style="color: #990000">);</span>
<span style="color: #000000">00038:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00039:</span> 
<span style="color: #000000">00040:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Const</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> AbsExpr <span style="color: #FF0000">{</span>
<span style="color: #000000">00041:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> <span style="color: #009900">int</span> _v<span style="color: #990000">;</span>
<span style="color: #000000">00042:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #000000">Const</span></span><span style="color: #990000">(</span><span style="color: #009900">int</span> v<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00043:</span>     _v <span style="color: #990000">=</span> v<span style="color: #990000">;</span>
<span style="color: #000000">00044:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00045:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">evaluate</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00046:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _v<span style="color: #990000">;</span>
<span style="color: #000000">00047:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00048:</span>   <span style="color: #008080">Object</span> <span style="font-weight: bold"><span style="color: #000000">acceptPreOrder</span></span><span style="color: #990000">(</span><span style="color: #008080">PreorderIterator</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00049:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _v<span style="color: #990000">;</span>
<span style="color: #000000">00050:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00051:</span>   <span style="color: #008080">Object</span> <span style="font-weight: bold"><span style="color: #000000">acceptPostOrder</span></span><span style="color: #990000">(</span><span style="color: #008080">PostorderIterator</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00052:</span>     i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">markVisited</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00053:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _v<span style="color: #990000">;</span>
<span style="color: #000000">00054:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00055:</span>   <span style="color: #008080">Object</span> <span style="font-weight: bold"><span style="color: #000000">acceptBreadth</span></span><span style="color: #990000">(</span><span style="color: #008080">BreadthIterator</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00056:</span>     i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">markVisited</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00057:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _v<span style="color: #990000">;</span>
<span style="color: #000000">00058:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00059:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00060:</span> 
<span style="color: #000000">00061:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">BinOp</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> AbsExpr <span style="color: #FF0000">{</span>
<span style="color: #000000">00062:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> AbsExpr _l<span style="color: #990000">;</span>
<span style="color: #000000">00063:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> AbsExpr _r<span style="color: #990000">;</span>
<span style="color: #000000">00064:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">final</span></span> Op _op<span style="color: #990000">;</span>
<span style="color: #000000">00065:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #000000">BinOp</span></span><span style="color: #990000">(</span><span style="color: #008080">AbsExpr</span> l<span style="color: #990000">,</span> <span style="color: #008080">Op</span> op<span style="color: #990000">,</span> <span style="color: #008080">AbsExpr</span> r<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00066:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">((</span>l <span style="color: #990000">==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">)</span> <span style="color: #990000">||</span> <span style="color: #990000">(</span>op <span style="color: #990000">==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">)</span> <span style="color: #990000">||</span> <span style="color: #990000">(</span>r <span style="color: #990000">==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">))</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00067:</span>       <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">IllegalArgumentException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00068:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00069:</span>     _op <span style="color: #990000">=</span> op<span style="color: #990000">;</span>
<span style="color: #000000">00070:</span>     _l <span style="color: #990000">=</span> l<span style="color: #990000">;</span>
<span style="color: #000000">00071:</span>     _r <span style="color: #990000">=</span> r<span style="color: #990000">;</span>
<span style="color: #000000">00072:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00073:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">int</span> <span style="font-weight: bold"><span style="color: #000000">evaluate</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00074:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _op<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">eval</span></span><span style="color: #990000">(</span>_l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">evaluate</span></span><span style="color: #990000">(),</span> _r<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">evaluate</span></span><span style="color: #990000">());</span>
<span style="color: #000000">00075:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00076:</span>   <span style="color: #008080">Object</span> <span style="font-weight: bold"><span style="color: #000000">acceptPreOrder</span></span><span style="color: #990000">(</span><span style="color: #008080">PreorderIterator</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00077:</span>     i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addNode</span></span><span style="color: #990000">(</span>_r<span style="color: #990000">);</span>
<span style="color: #000000">00078:</span>     i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addNode</span></span><span style="color: #990000">(</span>_l<span style="color: #990000">);</span>
<span style="color: #000000">00079:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _op<span style="color: #990000">;</span>
<span style="color: #000000">00080:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00081:</span>   <span style="color: #008080">Object</span> <span style="font-weight: bold"><span style="color: #000000">acceptPostOrder</span></span><span style="color: #990000">(</span><span style="color: #008080">PostorderIterator</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00082:</span>     i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">markVisited</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00083:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">visited</span></span><span style="color: #990000">(</span>_r<span style="color: #990000">))</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00084:</span>       <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _op<span style="color: #990000">;</span>
<span style="color: #000000">00085:</span>     <span style="color: #FF0000">}</span> <span style="font-weight: bold"><span style="color: #0000FF">else</span></span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00086:</span>       i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addNode</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00087:</span>       <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">visited</span></span><span style="color: #990000">(</span>_l<span style="color: #990000">))</span>
<span style="color: #000000">00088:</span>         <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _r<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">acceptPostOrder</span></span><span style="color: #990000">(</span>i<span style="color: #990000">);</span>
<span style="color: #000000">00089:</span>       <span style="font-weight: bold"><span style="color: #0000FF">else</span></span>
<span style="color: #000000">00090:</span>         <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">acceptPostOrder</span></span><span style="color: #990000">(</span>i<span style="color: #990000">);</span>
<span style="color: #000000">00091:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00092:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00093:</span>   <span style="color: #008080">Object</span> <span style="font-weight: bold"><span style="color: #000000">acceptBreadth</span></span><span style="color: #990000">(</span><span style="color: #008080">BreadthIterator</span> i<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00094:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">visited</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">))</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00095:</span>       i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addNode</span></span><span style="color: #990000">(</span>_l<span style="color: #990000">);</span>
<span style="color: #000000">00096:</span>       i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addNode</span></span><span style="color: #990000">(</span>_r<span style="color: #990000">);</span>
<span style="color: #000000">00097:</span>       <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00098:</span>     <span style="color: #FF0000">}</span> <span style="font-weight: bold"><span style="color: #0000FF">else</span></span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00099:</span>       i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">markVisited</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00100:</span>       i<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addNode</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00101:</span>       <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _op<span style="color: #990000">;</span>
<span style="color: #000000">00102:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00103:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00104:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00105:</span> 
<span style="color: #000000">00106:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">PreorderIterator</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Iterator <span style="color: #FF0000">{</span>
<span style="color: #000000">00107:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> Stack<span style="color: #990000">&lt;</span>AbsExpr<span style="color: #990000">&gt;</span> _s <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> Stack<span style="color: #990000">&lt;</span>AbsExpr<span style="color: #990000">&gt;();</span>
<span style="color: #000000">00108:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">boolean</span> <span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00109:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #990000">!</span> _s<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">empty</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00110:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00111:</span>   <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">addNode</span></span><span style="color: #990000">(</span><span style="color: #008080">AbsExpr</span> e<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00112:</span>     _s<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">push</span></span><span style="color: #990000">(</span>e<span style="color: #990000">);</span>
<span style="color: #000000">00113:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00114:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Object</span> <span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00115:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">())</span>
<span style="color: #000000">00116:</span>       <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #990000">(</span>_s<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">pop</span></span><span style="color: #990000">()).</span><span style="font-weight: bold"><span style="color: #000000">acceptPreOrder</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00117:</span>     <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">NoSuchElementException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00118:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00119:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">remove</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00120:</span>     <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">UnsupportedOperationException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00121:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00122:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00123:</span> 
<span style="color: #000000">00124:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">PostorderIterator</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Iterator <span style="color: #FF0000">{</span>
<span style="color: #000000">00125:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> Set<span style="color: #990000">&lt;</span>AbsExpr<span style="color: #990000">&gt;</span> _v <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> HashSet<span style="color: #990000">&lt;</span>AbsExpr<span style="color: #990000">&gt;();</span>
<span style="color: #000000">00126:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> Stack<span style="color: #990000">&lt;</span>AbsExpr<span style="color: #990000">&gt;</span> _s <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> Stack<span style="color: #990000">&lt;</span>AbsExpr<span style="color: #990000">&gt;();</span>
<span style="color: #000000">00127:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">boolean</span> <span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00128:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #990000">!</span> _s<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">empty</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00129:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00130:</span>   <span style="color: #009900">boolean</span> <span style="font-weight: bold"><span style="color: #000000">visited</span></span><span style="color: #990000">(</span><span style="color: #008080">AbsExpr</span> e<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00131:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _v<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">contains</span></span><span style="color: #990000">(</span>e<span style="color: #990000">);</span>
<span style="color: #000000">00132:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00133:</span>   <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">markVisited</span></span><span style="color: #990000">(</span><span style="color: #008080">AbsExpr</span> e<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00134:</span>     _v<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">add</span></span><span style="color: #990000">(</span>e<span style="color: #990000">);</span>
<span style="color: #000000">00135:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00136:</span>   <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">addNode</span></span><span style="color: #990000">(</span><span style="color: #008080">AbsExpr</span> e<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00137:</span>     _s<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">push</span></span><span style="color: #990000">(</span>e<span style="color: #990000">);</span>
<span style="color: #000000">00138:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00139:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Object</span> <span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00140:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">())</span>
<span style="color: #000000">00141:</span>       <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #990000">(</span>_s<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">pop</span></span><span style="color: #990000">()).</span><span style="font-weight: bold"><span style="color: #000000">acceptPostOrder</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00142:</span>     <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">NoSuchElementException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00143:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00144:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">remove</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00145:</span>     <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">UnsupportedOperationException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00146:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00147:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00148:</span> 
<span style="color: #000000">00149:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">BreadthIterator</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> Iterator <span style="color: #FF0000">{</span>
<span style="color: #000000">00150:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> Set<span style="color: #990000">&lt;</span>AbsExpr<span style="color: #990000">&gt;</span> _v <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> HashSet<span style="color: #990000">&lt;</span>AbsExpr<span style="color: #990000">&gt;();</span>
<span style="color: #000000">00151:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> List<span style="color: #990000">&lt;</span>AbsExpr<span style="color: #990000">&gt;</span> _l <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> ArrayList<span style="color: #990000">&lt;</span>AbsExpr<span style="color: #990000">&gt;();</span>
<span style="color: #000000">00152:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">boolean</span> <span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00153:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="color: #990000">!</span> _l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">isEmpty</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00154:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00155:</span>   <span style="color: #009900">boolean</span> <span style="font-weight: bold"><span style="color: #000000">visited</span></span><span style="color: #990000">(</span><span style="color: #008080">AbsExpr</span> e<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00156:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> _v<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">contains</span></span><span style="color: #990000">(</span>e<span style="color: #990000">);</span>
<span style="color: #000000">00157:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00158:</span>   <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">markVisited</span></span><span style="color: #990000">(</span><span style="color: #008080">AbsExpr</span> e<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00159:</span>     _v<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">add</span></span><span style="color: #990000">(</span>e<span style="color: #990000">);</span>
<span style="color: #000000">00160:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00161:</span>   <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">addNode</span></span><span style="color: #990000">(</span><span style="color: #008080">AbsExpr</span> e<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00162:</span>     _l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">add</span></span><span style="color: #990000">(</span>e<span style="color: #990000">);</span>
<span style="color: #000000">00163:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00164:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #008080">Object</span> <span style="font-weight: bold"><span style="color: #000000">next</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00165:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">hasNext</span></span><span style="color: #990000">())</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00166:</span>       <span style="color: #008080">AbsExpr</span> e <span style="color: #990000">=</span> _l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">get</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">);</span>
<span style="color: #000000">00167:</span>       _l<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">remove</span></span><span style="color: #990000">(</span><span style="color: #993399">0</span><span style="color: #990000">);</span>
<span style="color: #000000">00168:</span>       <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> e<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">acceptBreadth</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #000000">00169:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00170:</span>     <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">NoSuchElementException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00171:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00172:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">remove</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00173:</span>     <span style="font-weight: bold"><span style="color: #0000FF">throw</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">UnsupportedOperationException</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00174:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00175:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00176:</span> 
<span style="color: #000000">00177:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide011">A Tree: External Iterator in CSharp</a></span><span style="font-weight: normal"><a href="class-10-011.html"> [11/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          External iterators are much easier to write in C#, which
          maintains the stack for you.  Rather than <tt>return</tt>,
          use <tt>yield</tt>.
        </p>
        <p xmlns=""> </p><blockquote xmlns="">
<table width="97%">
<tr><td rowspan="1" colspan="1"><table width="100%" class="title"><tr><td rowspan="1" colspan="1"><b><a xmlns="http://www.w3.org/1999/xhtml" href="../code/html/tree_cs.html">file:tree.cs</a> [<a xmlns="http://www.w3.org/1999/xhtml" href="../code/src/tree.cs">source</a>]</b></td></tr></table></td></tr>
<tr><td rowspan="1" colspan="1"><table width="100%" class="code"><tr><td rowspan="1" colspan="1">

<pre xml:space="preserve"><tt><span style="color: #000000">00001:</span> <span style="font-style: italic"><span style="color: #9A1900">// from http://en.csharp-online.net/ECMA-334:_26.4_Implementation_example</span></span>
<span style="color: #000000">00002:</span> <span style="font-style: italic"><span style="color: #9A1900">// See also http://msdn.microsoft.com/msdnmag/issues/06/00/C20/default.aspx</span></span>
<span style="color: #000000">00003:</span> 
<span style="color: #000000">00004:</span> <span style="font-weight: bold"><span style="color: #000080">using</span></span> System<span style="color: #990000">;</span>
<span style="color: #000000">00005:</span> <span style="font-weight: bold"><span style="color: #000080">using</span></span> System<span style="color: #990000">.</span>Collections<span style="color: #990000">;</span>
<span style="color: #000000">00006:</span> <span style="font-weight: bold"><span style="color: #000080">using</span></span> System<span style="color: #990000">.</span>Collections<span style="color: #990000">.</span>Generic<span style="color: #990000">;</span>
<span style="color: #000000">00007:</span> 
<span style="color: #000000">00008:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Tree</span><span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;</span> <span style="color: #990000">:</span> IEnumerable<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;</span>
<span style="color: #000000">00009:</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00010:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #008080">T</span> <span style="font-weight: bold"><span style="color: #0000FF">value</span></span><span style="color: #990000">;</span>
<span style="color: #000000">00011:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #008080">Tree&lt;T&gt;</span> left<span style="color: #990000">;</span>
<span style="color: #000000">00012:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="color: #008080">Tree&lt;T&gt;</span> right<span style="color: #990000">;</span>
<span style="color: #000000">00013:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #000000">Tree</span></span><span style="color: #990000">(</span><span style="color: #008080">T</span> <span style="font-weight: bold"><span style="color: #0000FF">value</span></span><span style="color: #990000">,</span> <span style="color: #008080">Tree&lt;T&gt; left, Tree&lt;T&gt;</span> right<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00014:</span>     <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">value</span></span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">value</span></span><span style="color: #990000">;</span>
<span style="color: #000000">00015:</span>     <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>left <span style="color: #990000">=</span> left<span style="color: #990000">;</span>
<span style="color: #000000">00016:</span>     <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>right <span style="color: #990000">=</span> right<span style="color: #990000">;</span>
<span style="color: #000000">00017:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00018:</span>   <span style="font-style: italic"><span style="color: #9A1900">// Returns the elements postorder</span></span>
<span style="color: #000000">00019:</span>   <span style="color: #008080">IEnumerator&lt;T&gt;</span> IEnumerable<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;.</span><span style="font-weight: bold"><span style="color: #000000">GetEnumerator</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00020:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>left <span style="color: #990000">!=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">foreach</span></span> <span style="color: #990000">(</span>T x <span style="color: #008080">in</span> left<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">yield</span></span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> x<span style="color: #990000">;</span>
<span style="color: #000000">00021:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>right <span style="color: #990000">!=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">foreach</span></span> <span style="color: #990000">(</span>T x <span style="color: #008080">in</span> right<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">yield</span></span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> x<span style="color: #990000">;</span>
<span style="color: #000000">00022:</span>     <span style="font-weight: bold"><span style="color: #0000FF">yield</span></span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">value</span></span><span style="color: #990000">;</span>
<span style="color: #000000">00023:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00024:</span>   <span style="color: #008080">IEnumerator</span> IEnumerable<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">GetEnumerator</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00025:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span>  <span style="color: #990000">((</span>IEnumerable<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;)</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">GetEnumerator</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00026:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00027:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00028:</span> 
<span style="color: #000000">00029:</span> <span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Program</span>
<span style="color: #000000">00030:</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00031:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #008080">Tree&lt;T&gt;</span> MakeTree<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;(</span><span style="font-weight: bold"><span style="color: #0000FF">params</span></span> T<span style="color: #990000">[]</span> items<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00032:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #000000">MakeTree</span></span><span style="color: #990000">(</span>items<span style="color: #990000">,</span> <span style="color: #993399">0</span><span style="color: #990000">,</span> items<span style="color: #990000">.</span>Length <span style="color: #990000">-</span> <span style="color: #993399">1</span><span style="color: #990000">);</span>
<span style="color: #000000">00033:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00034:</span>   <span style="font-weight: bold"><span style="color: #0000FF">private</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #008080">Tree&lt;T&gt;</span> MakeTree<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;(</span>T<span style="color: #990000">[]</span> items<span style="color: #990000">,</span> <span style="color: #009900">int</span> left<span style="color: #990000">,</span> <span style="color: #009900">int</span> right<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00035:</span>     <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>left <span style="color: #990000">&gt;</span> right<span style="color: #990000">)</span> <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">;</span>
<span style="color: #000000">00036:</span>     <span style="color: #009900">int</span> i <span style="color: #990000">=</span> <span style="color: #990000">(</span>left <span style="color: #990000">+</span> right<span style="color: #990000">)</span> <span style="color: #990000">/</span> <span style="color: #993399">2</span><span style="color: #990000">;</span>
<span style="color: #000000">00037:</span>     <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> Tree<span style="color: #990000">&lt;</span>T<span style="color: #990000">&gt;(</span>items<span style="color: #990000">[</span>i<span style="color: #990000">],</span>
<span style="color: #000000">00038:</span>                        <span style="font-weight: bold"><span style="color: #000000">MakeTree</span></span><span style="color: #990000">(</span>items<span style="color: #990000">,</span> left<span style="color: #990000">,</span> i <span style="color: #990000">-</span> <span style="color: #993399">1</span><span style="color: #990000">),</span>
<span style="color: #000000">00039:</span>                        <span style="font-weight: bold"><span style="color: #000000">MakeTree</span></span><span style="color: #990000">(</span>items<span style="color: #990000">,</span> i <span style="color: #990000">+</span> <span style="color: #993399">1</span><span style="color: #990000">,</span> right<span style="color: #990000">));</span>
<span style="color: #000000">00040:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00041:</span> 
<span style="color: #000000">00042:</span> 
<span style="color: #000000">00043:</span>   <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">Main</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
<span style="color: #000000">00044:</span>     <span style="color: #FF0000">{</span>
<span style="color: #000000">00045:</span>       <span style="color: #008080">Tree&lt;int&gt;</span> t <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">MakeTree</span></span><span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">,</span> <span style="color: #993399">2</span><span style="color: #990000">,</span> <span style="color: #993399">3</span><span style="color: #990000">,</span> <span style="color: #993399">4</span><span style="color: #990000">,</span> <span style="color: #993399">5</span><span style="color: #990000">,</span> <span style="color: #993399">6</span><span style="color: #990000">,</span> <span style="color: #993399">7</span><span style="color: #990000">,</span> <span style="color: #993399">8</span><span style="color: #990000">,</span> <span style="color: #993399">9</span><span style="color: #990000">);</span>
<span style="color: #000000">00046:</span>       <span style="font-weight: bold"><span style="color: #0000FF">foreach</span></span> <span style="color: #990000">(</span><span style="color: #009900">int</span> i <span style="color: #008080">in</span> t<span style="color: #990000">)</span> Console<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">Write</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"{0} "</span><span style="color: #990000">,</span> i<span style="color: #990000">);</span>
<span style="color: #000000">00047:</span>       Console<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">WriteLine</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00048:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00049:</span>     <span style="color: #FF0000">{</span>
<span style="color: #000000">00050:</span>       <span style="color: #008080">Tree&lt;string&gt;</span> t <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">MakeTree</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"Mon"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"Tue"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"Wed"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"Thu"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"Fri"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"Sat"</span><span style="color: #990000">,</span> <span style="color: #FF0000">"Sun"</span><span style="color: #990000">);</span>
<span style="color: #000000">00051:</span>       <span style="font-weight: bold"><span style="color: #0000FF">foreach</span></span> <span style="color: #990000">(</span><span style="color: #009900">string</span> s <span style="color: #008080">in</span> t<span style="color: #990000">)</span> Console<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">Write</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"{0} "</span><span style="color: #990000">,</span> s<span style="color: #990000">);</span>
<span style="color: #000000">00052:</span>       Console<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">WriteLine</span></span><span style="color: #990000">();</span>
<span style="color: #000000">00053:</span>     <span style="color: #FF0000">}</span>
<span style="color: #000000">00054:</span>   <span style="color: #FF0000">}</span>
<span style="color: #000000">00055:</span> <span style="color: #FF0000">}</span>
<span style="color: #000000">00056:</span> </tt></pre>

</td></tr></table>
</td></tr></table>
</blockquote>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide012">Review: OO Mechanisms: Subtyping (Polymorphism)</a></span><span style="font-weight: normal"><a href="class-10-012.html"> [12/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          Objects may be seen at more abstract (or more concrete)
          types.
        </p>
        <p xmlns="">
          The set of messages available to the user depend
          upon the declared type at which the user sees the object.
        </p>

<pre xmlns="" xml:space="preserve"><tt><span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">I</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">();</span> <span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">D</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> I <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"D.m"</span><span style="color: #990000">);</span>
                       <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">f</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"D.f"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Main</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">(</span>String<span style="color: #990000">[]</span> args<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="color: #008080">I</span> x <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">D</span></span><span style="color: #990000">();</span>
    x<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">f</span></span><span style="color: #990000">();</span>  <span style="font-style: italic"><span style="color: #9A1900">// access denied -- won't compile</span></span>
    x<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">();</span>  <span style="font-style: italic"><span style="color: #9A1900">// prints "D.m"</span></span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span>
</tt></pre>

      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide013">Review: OO Mechanisms: Dynamic Dispatch</a></span><span style="font-weight: normal"><a href="class-10-013.html"> [13/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          Objects may be seen at more abstract (or more concrete)
          types.
        </p>
        <p xmlns="">
          The way an object responds to a message depends upon its
          actual type.
        </p>
        <p xmlns="">
          This is called <i>single dispatch</i>.
        </p>
        <p xmlns="">
          GoF: In single-dispatch languages, two criteria determine
          which operation will fulfill a request: the name of the
          request and the [actual] type of receiver.
        </p>

<pre xmlns="" xml:space="preserve"><tt><span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">I</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">();</span> <span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">C</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> I <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"C.m"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">D</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> I <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"D.m"</span><span style="color: #990000">);</span>
                       <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">f</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"D.f"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Main</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">(</span>String<span style="color: #990000">[]</span> args<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="color: #008080">I</span> x <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">D</span></span><span style="color: #990000">();</span>
    x<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">();</span>  <span style="font-style: italic"><span style="color: #9A1900">// prints "D.m"</span></span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span>
</tt></pre>

      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide014">Review: OO Mechanisms: Double Dispatch</a></span><span style="font-weight: normal"><a href="class-10-014.html"> [14/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          The method body depends upon the actual type of two objects.
        </p>
        <p xmlns="">
          GoF: "Double-dispatch" simply means the operation that gets
          executed depends on the [name] of request and the types of
          two receivers. 
        </p>

<pre xmlns="" xml:space="preserve"><tt><span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">I</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span> <span style="color: #990000">(</span><span style="color: #008080">V</span> z<span style="color: #990000">);</span>
<span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">C</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> I <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span> <span style="color: #990000">(</span><span style="color: #008080">V</span> z<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> z<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">visitC</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span>  
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">D</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> I <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">accept</span></span> <span style="color: #990000">(</span><span style="color: #008080">V</span> z<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> z<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">visitD</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span>  
<span style="font-weight: bold"><span style="color: #0000FF">interface</span></span> <span style="color: #008080">V</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">visitC</span></span><span style="color: #990000">(</span><span style="color: #008080">C</span> x<span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">visitD</span></span><span style="color: #990000">(</span><span style="color: #008080">D</span> x<span style="color: #990000">);</span>
<span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">U</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> V <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">visitC</span></span><span style="color: #990000">(</span><span style="color: #008080">C</span> x<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"C accepted U"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">visitD</span></span><span style="color: #990000">(</span><span style="color: #008080">D</span> x<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"D accepted U"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">W</span> <span style="font-weight: bold"><span style="color: #0000FF">implements</span></span> V <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">visitC</span></span><span style="color: #990000">(</span><span style="color: #008080">C</span> x<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"C accepted W"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">visitD</span></span><span style="color: #990000">(</span><span style="color: #008080">D</span> x<span style="color: #990000">)</span> <span style="color: #FF0000">{</span> System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"D accepted W"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Main</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">(</span>String<span style="color: #990000">[]</span> args<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="color: #008080">I</span> x <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">D</span></span><span style="color: #990000">();</span>
    <span style="color: #008080">V</span> z <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">W</span></span><span style="color: #990000">();</span>
    x<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">accept</span></span><span style="color: #990000">(</span>z<span style="color: #990000">);</span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span>
</tt></pre>

        <p xmlns="">
          GoF: Accept is a double-dispatch operation. Its
          meaning depends on two types: the Visitor's and the
          Element's. Double-dispatching lets visitors request
          different operations on each class of element.
        </p>
        <p xmlns="">
          <a xmlns="http://www.w3.org/1999/xhtml" href="http://www.cs.washington.edu/research/projects/cecil/www/">Cecil</a>
          and other languages support multiple dispatch syntactically.
        </p>
        <p xmlns="">
          This is much easier in Cecil!
        </p>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide015">Review: OO Mechanisms: Delegation</a></span><span style="font-weight: normal"><a href="class-10-015.html"> [15/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          (Partial) responsibility for a message is given to another
          object.
        </p>
        <p xmlns="">
          The receiving object forwards messages to another object,
          perhaps doing some processing before and after the call.
        </p>

<pre xmlns="" xml:space="preserve"><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">C</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"C.m"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">D</span> <span style="color: #FF0000">{</span>
  <span style="color: #008080">C</span> z <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">C</span></span><span style="color: #990000">();</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">f</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> z<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">();</span> System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"D.f"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> z<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">();</span> <span style="color: #FF0000">}</span>  <span style="font-style: italic"><span style="color: #9A1900">// pure delegation</span></span>
<span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Main</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">(</span>String<span style="color: #990000">[]</span> args<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="color: #008080">D</span> x <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">D</span></span><span style="color: #990000">();</span>
    x<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">f</span></span><span style="color: #990000">();</span> <span style="font-style: italic"><span style="color: #9A1900">// prints "C.m D.f"</span></span>
    x<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">();</span> <span style="font-style: italic"><span style="color: #9A1900">// prints "C.m"</span></span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span>
</tt></pre>

        <p xmlns="">
          Note that delegation is often referred to as
          <i>composition</i>.  This is different from the strict sense
          of composition used in the UML.
        </p>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide016">Review: OO Mechanisms: Classes</a></span><span style="font-weight: normal"><a href="class-10-016.html"> [16/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          Classes are a mechanism for describing objects.
        </p>
        <p xmlns="">
          Constructors are used to create instances.
        </p>
        <p xmlns="">
          <a xmlns="http://www.w3.org/1999/xhtml" href="http://www.google.com/search?query=prototype%20based%20languages">Prototype-based languages</a>
          use prototype objects and cloning.
          These languages allow either <i>method update</i> (assignment of
          new methods to objects) or <i>multi-methods</i> (definition
          of methods outside objects or classes).
        </p>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide017">Review: OO Mechanisms: Subclassing (Inheritance)</a></span><span style="font-weight: normal"><a href="class-10-017.html"> [17/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          (Partial) responsibility for a message is given to a class
          other than the actual class of the object.
        </p>
        <p xmlns="">
          The receiving object's actual class inherits a method, or it
          explicitly invokes method of an ancestor class, perhaps
          doing some processing before and after the call.
        </p>

<pre xmlns="" xml:space="preserve"><tt><span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">C</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"C.m"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">D</span> <span style="font-weight: bold"><span style="color: #0000FF">extends</span></span> C <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">f</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span> <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">();</span> System<span style="color: #990000">.</span>out<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">println</span></span><span style="color: #990000">(</span><span style="color: #FF0000">"D.f"</span><span style="color: #990000">);</span> <span style="color: #FF0000">}</span>
  <span style="font-style: italic"><span style="color: #9A1900">// pure inheritance of m</span></span>
<span style="color: #FF0000">}</span>
<span style="font-weight: bold"><span style="color: #0000FF">class</span></span> <span style="color: #008080">Main</span> <span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">public</span></span> <span style="font-weight: bold"><span style="color: #0000FF">static</span></span> <span style="color: #009900">void</span> <span style="font-weight: bold"><span style="color: #000000">main</span></span><span style="color: #990000">(</span>String<span style="color: #990000">[]</span> args<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="color: #008080">D</span> x <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">D</span></span><span style="color: #990000">();</span>
    x<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">f</span></span><span style="color: #990000">();</span> <span style="font-style: italic"><span style="color: #9A1900">// prints "C.m D.f"</span></span>
    x<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">m</span></span><span style="color: #990000">();</span> <span style="font-style: italic"><span style="color: #9A1900">// prints "C.m"</span></span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span>
</tt></pre>

      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide018">Review: Pattern Summary: OO Mechanisms</a></span><span style="font-weight: normal"><a href="class-10-018.html"> [18/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          <b>Interface</b>: Primitive for describing the <i>type</i>
          or <i>interface</i> of an object.
        </p>
        <p xmlns="">
          <b>Class</b>: Primitive for describing implementation of an
          object.
        </p>
        <p xmlns="">
          <b>Constructor</b>: Primitive construct for building
          objects.
        </p>
        <p xmlns="">
          <b>Delegation</b>: (Partial) responsibility for a message is
          given to another object.
        </p>
        <p xmlns="">
        <span xmlns="http://www.w3.org/1999/xhtml" class="blue">
          <b xmlns="">Subclassing</b>: (Partial) responsibility for a message
          is given to a class other than the actual class of the
          object.
        </span>
        </p>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide019">Review: Pattern Summary: Basic Concepts</a></span><span style="font-weight: normal"><a href="class-10-019.html"> [19/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          <b>Immutable Data Class</b>: Unchanging data (eg, String).
        </p>
        <p xmlns="">
          <b>Mutable Data Class</b>: Changing data (eg, an Employee
          class that contains salary information).
        </p>
        <p xmlns="">
          <b>Collection Class</b>: A collection.  May be mutable or
          immutable.
        </p>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide020">Review: Pattern Summary: Controlling the number of instances</a></span><span style="font-weight: normal"><a href="class-10-020.html"> [20/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          <b>Static Class</b>: A set of global variables and
          functions.
        </p>
        <p xmlns="">
          <b>Singleton</b>: A polymorphic version of a <i>static
          class</i>.  A set of global variables and functions,
          allowing for dynamic dispatch: actual functions not fixed at
          compile time.
        </p>
        <p xmlns="">
          <b>Typesafe Enumeration</b>: An immutable data class whose
          number of instances is determined at compile-time.  The
          instances are globally accessible.
        </p>
        <p xmlns="">
          <b>Flyweight</b>: Ensure that at most once instance of an
          immutable data class for each value of the attributes.
          Similar to typesafe enumeration, but the number of possible
          instances may be large and there are no global references.
          Must keep references to all instances that have been created.
          <span xmlns="http://www.w3.org/1999/xhtml" class="blue">Not on final exam.</span>
        </p>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide021">Review: Pattern Summary: Creating instances</a></span><span style="font-weight: normal"><a href="class-10-021.html"> [21/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          <b>Static Factory</b>: a static class whose purpose is to
          generate instances of an interface (or interfaces).  The
          interface and factory are public, but the implementing
          classes are not.
        </p>
        <p xmlns="">
          <b>Abstract Factory</b>: A polymorphic version of a
          <i>static factory</i>.  Abstract factories are usually
          singletons.
          <span xmlns="http://www.w3.org/1999/xhtml" class="blue">Not on final exam.</span>
        </p>
        <p xmlns="">
          <b>Builder</b>: A mutable object used to build an immutable
          object.  Add pieces to the builder gradually, then convert
          to its immutable representation (eg, StringBuilder).
        </p>
        <p xmlns="">
          <b>Prototype (clone)</b>: A method that generates an object
          based on the actual type of the receiver.  The returned
          object is a copy of the receiver.
        </p>
        <p xmlns="">
          <b>Factory Method</b>: A method that generates an object
          based on the actual type of the receiver.  Factory methods
          are used to tie together related interfaces (eg, Collection
          and Iterator).  Once I have a concrete instance of the
          primary interface (Collection), I can use it to generate
          concrete instances of the subsidiary interface (Iterator).
          <span xmlns="http://www.w3.org/1999/xhtml" class="blue">Not on final exam.</span>
        </p>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide022">Review: Pattern Summary: Structuring Behavior</a></span><span style="font-weight: normal"><a href="class-10-022.html"> [22/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          <b>Strategy</b>: Encapsulate variation into a separate
          object.  A method accesses the variation (strategy) by
          delegating to a field or parameter.
        </p>
        <p xmlns="">
          <b>Template Method</b>: Encapsulate variation into a
          separate subclass.  The template method accesses the
          variation (hook) by calling a method implemented in the
          subclass.  Hook methods are often abstract in the
          superclass.
        </p>
        <p xmlns="">
          <b>Command</b>: Encapsulate a function as an object.  The
          command can then be accessed from many places.  It may also
          support undo/redo.
        </p>
        <p xmlns="">
          <b>Observer (Publish/Subscribe)</b>: Allow many subscribers
          to observe changes in the publisher.  Subscribers attach
          themselves to the publisher.  The publisher calls back to
          the subscribers to notify them of changes.
        </p>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide023">Review: Pattern Summary: Structuring Behavior (Replacing Conditionals)</a></span><span style="font-weight: normal"><a href="class-10-023.html"> [23/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          <b>Null Object</b>: Replace null reference with an object
          with trivial behavior.  Eliminates if-null-then-else.
        </p>
        <p xmlns="">
          <b>Proxy</b>: Keep an interface, but delegate functionality
          to another object.  A proxy objects sole purpose is to
          control (or enable) access to another object.  Eliminates
          if-then-else.
        </p>
        <p xmlns="">
          <b>State</b>: Create the illusion that an object changes its
          actual type (using delegation to a field).  Eliminates
          switch/case.
        </p>
        <p xmlns="">
          <b>Chain of Responsibility</b>: Give more than one object a
          chance to handle a request. Chain the receiving objects and
          pass the request along the chain until an object handles it.
          Eliminates switch/case.
          <span xmlns="http://www.w3.org/1999/xhtml" class="blue">Not on final exam.</span>
        </p>
      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide024">Review: Pattern Summary: Collections</a></span><span style="font-weight: normal"><a href="class-10-024.html"> [24/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          <b>Composite</b>: Make collections of objects have the same
          interface as single objects.
        </p>
















      <p> </p><table width="100%" class="title"><tr><td><span style="font-weight: bold; font-size: larger"><a name="slide025">What now?</a></span><span style="font-weight: normal"><a href="class-10-025.html"> [25/25] </a></span></td></tr></table><p> </p>
        <p xmlns="">
          The following classes emphasize programming with patterns:
        </p>
        <ul xmlns="">
          <li>
            SE546: Software Architecture and Design for Desktop Applications 
          </li>
          <li>
            SE552: Concurrent Software Development 
          </li>
          <li>
            SE554: Enterprise Component Architecture 
          </li>
          <li>
            CSC531: Introduction to Bioinformatics   
          </li>
        </ul>
      <hr/><p class="flush">
      Revised: 2008/09/03 15:27</p></body></html>
